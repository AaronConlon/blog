<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta name="description" content="javascript node deno linux web developer"/><meta charSet="utf-8"/><link rel="icon" href="data:image/svg+xml,&lt;svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22&gt;&lt;text y=%22.9em%22 font-size=%2290%22&gt;🎯&lt;/text&gt;&lt;/svg&gt;"/><title>Powershell随写</title><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/reset-css@5.0.1/reset.min.css"/><link rel="stylesheet" href="/blog/post.css"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-J0BNBT8YXG"></script><script><!-- Global site tag (gtag.js) - Google Analytics -->
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());        
            gtag('config', 'G-J0BNBT8YXG');</script><meta name="next-head-count" content="9"/><link rel="preload" href="/blog/_next/static/css/e329e062f634851cc5d0.css" as="style"/><link rel="stylesheet" href="/blog/_next/static/css/e329e062f634851cc5d0.css" data-n-g=""/><link rel="preload" href="/blog/_next/static/css/d5a8ab09696082e07b0c.css" as="style"/><link rel="stylesheet" href="/blog/_next/static/css/d5a8ab09696082e07b0c.css" data-n-p=""/><noscript data-n-css="true"></noscript><link rel="preload" href="/blog/_next/static/chunks/main-bc20978b5b49cb620506.js" as="script"/><link rel="preload" href="/blog/_next/static/chunks/webpack-eb080e3f091731f228fb.js" as="script"/><link rel="preload" href="/blog/_next/static/chunks/framework.9ec1f7868b3e9d138cdd.js" as="script"/><link rel="preload" href="/blog/_next/static/chunks/commons.d877dcdd17afd7219ae3.js" as="script"/><link rel="preload" href="/blog/_next/static/chunks/6335da8543c52d3af527c387f688061357787349.7e9e1b66dd81783d6900.js" as="script"/><link rel="preload" href="/blog/_next/static/chunks/pages/_app-4e649ed46ef47e92b24e.js" as="script"/><link rel="preload" href="/blog/_next/static/chunks/2c3b9bffc7150b37a7b3810dfcf1c0b0fac2bd18.c2ce14a235a03ef7811d.js" as="script"/><link rel="preload" href="/blog/_next/static/chunks/pages/posts/%5Bslug%5D-ece295f9976e557edb76.js" as="script"/></head><body><div id="__next"><style data-emotion-css="d6jcgn">html{line-height:1.15;-webkit-text-size-adjust:100%;}body{margin:0;}main{display:block;}h1{font-size:2em;margin:0.67em 0;}hr{box-sizing:content-box;height:0;overflow:visible;}pre{font-family:monospace,monospace;font-size:1em;}a{background-color:transparent;}abbr[title]{border-bottom:none;-webkit-text-decoration:underline;text-decoration:underline;-webkit-text-decoration:underline dotted;-webkit-text-decoration:underline dotted;text-decoration:underline dotted;}b,strong{font-weight:bolder;}code,kbd,samp{font-family:monospace,monospace;font-size:1em;}small{font-size:80%;}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline;}sub{bottom:-0.25em;}sup{top:-0.5em;}img{border-style:none;}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0;}button,input{overflow:visible;}button,select{text-transform:none;}button::-moz-focus-inner,[type="button"]::-moz-focus-inner,[type="reset"]::-moz-focus-inner,[type="submit"]::-moz-focus-inner{border-style:none;padding:0;}fieldset{padding:0.35em 0.75em 0.625em;}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal;}progress{vertical-align:baseline;}textarea{overflow:auto;}[type="checkbox"],[type="radio"]{box-sizing:border-box;padding:0;}[type="number"]::-webkit-inner-spin-button,[type="number"]::-webkit-outer-spin-button{-webkit-appearance:none !important;}input[type="number"]{-moz-appearance:textfield;}[type="search"]{-webkit-appearance:textfield;outline-offset:-2px;}[type="search"]::-webkit-search-decoration{-webkit-appearance:none !important;}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit;}details{display:block;}summary{display:list-item;}template{display:none;}[hidden]{display:none !important;}html{box-sizing:border-box;font-family:sans-serif;}*,*::before,*::after{box-sizing:border-box;}blockquote,dl,dd,h1,h2,h3,h4,h5,h6,hr,figure,p,pre{margin:0;}button{background:transparent;padding:0;}fieldset{margin:0;padding:0;}ol,ul{margin:0;padding:0;}html{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";line-height:1.5;-webkit-font-smoothing:antialiased;-webkit-text-size-adjust:100%;text-rendering:optimizelegibility;}hr{border-top-width:1px;}img{border-style:solid;}textarea{resize:vertical;}button,[role="button"]{cursor:pointer;}button::-moz-focus-inner{border:0 !important;}table{border-collapse:collapse;}h1,h2,h3,h4,h5,h6{font-size:inherit;font-weight:inherit;}a{color:inherit;-webkit-text-decoration:inherit;text-decoration:inherit;}button,input,optgroup,select,textarea{padding:0;line-height:inherit;color:inherit;}pre,code,kbd,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;}img,svg,video,canvas,audio,iframe,embed,object{display:block;vertical-align:middle;}img,video{max-width:100%;height:auto;}html{line-height:1.5;color:#1A202C;}*,*::before,*::after{border-width:0;border-style:solid;border-color:#E2E8F0;}input:-ms-input-placeholder,textarea:-ms-input-placeholder{color:#A0AEC0;}input::-ms-input-placeholder,textarea::-ms-input-placeholder{color:#A0AEC0;}input::-webkit-input-placeholder,textarea::-webkit-input-placeholder{color:#A0AEC0;}input::-moz-placeholder,textarea::-moz-placeholder{color:#A0AEC0;}input:-ms-input-placeholder,textarea:-ms-input-placeholder{color:#A0AEC0;}input::placeholder,textarea::placeholder{color:#A0AEC0;}</style><div><div class="layout_container__1BBI- css-0"><header><div class="css-0"><style data-emotion-css="em7ozm">.css-em7ozm{font-size:2.25rem;line-height:1.25;font-weight:700;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";text-align:center;margin:0 auto;padding:1.4rem 1rem;color:#0069d6;}@media screen and (min-width:48em){.css-em7ozm{font-size:3rem;}}</style><h1 class="css-em7ozm"><a href="/blog">妙才<style data-emotion-css="1i1myri">.css-1i1myri{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";font-size:30%;}</style><sub class="css-1i1myri">blog</sub></a></h1></div></header><main><div class="css-0"><style data-emotion-css="t9c2rr">.css-t9c2rr{width:100%;margin:0 auto;padding-bottom:2rem;max-width:960px;}</style><div class="css-t9c2rr"><style data-emotion-css="8atqhb">.css-8atqhb{width:100%;}</style><img alt="" class="css-8atqhb"/></div><style data-emotion-css="1td051d">.css-1td051d{width:100%;margin:0 auto;max-width:960px;}</style><div class="css-1td051d"><style data-emotion-css="1299f13">.css-1299f13{font-size:1.875rem;line-height:2.5rem!important;font-weight:700;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";text-align:center;overflow:hidden;}@media screen and (min-width:30em){.css-1299f13{line-height:3rem!important;}}@media screen and (min-width:48em){.css-1299f13{font-size:2.25rem;}}</style><h1 class="css-1299f13">Powershell随写</h1><style data-emotion-css="7e9jz6">.css-7e9jz6{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-direction:row;-ms-flex-direction:row;flex-direction:row;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;height:2rem;margin:0 auto;margin-right:0.4rem;float:right;}</style><div id="tags" class="css-7e9jz6"><style data-emotion-css="qgikqf">.css-qgikqf{display:inline-block;padding-left:8px;padding-right:0.25rem;text-transform:uppercase;font-size:0.6rem;border-radius:5px;font-weight:700;white-space:nowrap;vertical-align:middle;background-color:#c6f6d5;color:#22543d;height:2rem;line-height:2rem;min-width:4rem;}</style><div class="css-qgikqf">powershell</div></div><style data-emotion-css="8ddayy">.css-8ddayy{display:-webkit-inline-box;display:-webkit-inline-flex;display:-ms-inline-flexbox;display:inline-flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;min-height:2rem;max-width:100%;border-radius:0.25rem;font-weight:500;min-width:2rem;padding-left:0.75rem;padding-right:0.75rem;background-color:#c6f6d5;color:#22543d;margin-bottom:2rem;font-size:0.6rem;margin-left:0.4rem;}</style><div class="css-8ddayy">最后更新: <!-- -->2020-08-03</div><div style="margin:0 1rem"><h2>chapter1：getting started with powershell</h2>
<h3>1.1 允许在你的机器上运行脚本</h3>
<pre><code class="hljs language-powershell"><span class="lineNumber">1</span><span class="hljs-comment"># 以管理员身份运行,这条命令将修改注册表,注册表中保存了powershell很多默认配置项</span>
<span class="lineNumber">2</span><span class="hljs-built_in">Set-ExecutionPolicy</span> RemoteSigned</code></pre> 

<p>将powershell的运行策略修改为运行未签名的脚本运行.或者通过管理员权限打开一个终端,执行脚本的时候指明使用<code>bypass</code>策略.</p>
<pre><code class="hljs language-powershell"><span class="lineNumber">1</span>powershell.exe <span class="hljs-literal">-ExecutionPolicy</span> Bypass <span class="hljs-operator">-File</span> <span class="hljs-string">"c:\MyScript.ps1"</span>
<span class="lineNumber">2</span><span class="hljs-comment"># 或者在此控制台先执行</span>
<span class="lineNumber">3</span><span class="hljs-built_in">Set-ExecutionPolicy</span> Bypass <span class="hljs-keyword">Process</span></code></pre> 

<h3>1.2 alias和简单函数</h3>
<p>举个例子,<code>write-output</code>和<code>write-host</code>都能接受字符并且输出到屏幕,但是<code>write-output</code>还能返回输出的值作为结果,这在变量引用和管道传递方面很有用.简单函数不同但是结果相同,这在powershell中非常常见.</p>
<p>同一个命令,可以有不同的别名,例如<code>write-output</code>的<code>alias</code>有<code>echo</code>和<code>write</code>.甚至,可以直接用单引号或者双引号括起来直接输出:</p>
<pre><code class="hljs language-powershell"><span class="lineNumber">1</span><span class="hljs-string">"hello world"</span>
<span class="lineNumber">2</span><span class="hljs-string">'hello world'</span>
<span class="lineNumber">3</span> 
<span class="lineNumber">4</span><span class="hljs-comment"># alias即别名,一条命令可以有不同的别名,就像人可以有不同的外号,如下举例</span>
<span class="lineNumber">5</span><span class="hljs-built_in">ls</span>
<span class="lineNumber">6</span><span class="hljs-built_in">dir</span>
<span class="lineNumber">7</span><span class="hljs-comment"># 都是get-childitem的alias</span></code></pre> 

<p>这些是系统自带的alias,我们可以自己增加,例如:</p>
<pre><code class="hljs language-powershell"><span class="lineNumber">1</span><span class="hljs-built_in">set-alias</span> <span class="hljs-literal">-Name</span> ping <span class="hljs-literal">-value</span> <span class="hljs-built_in">test-netconnection</span>
<span class="lineNumber">2</span> 
<span class="lineNumber">3</span><span class="hljs-comment"># 如下所示</span>
<span class="lineNumber">4</span>➜  Markdown笔记 <span class="hljs-built_in">Test-NetConnection</span> www.baidu.com
<span class="lineNumber">5</span>ComputerName           : www.baidu.com
<span class="lineNumber">6</span>RemoteAddress          : <span class="hljs-number">14.215</span>.<span class="hljs-number">177.39</span>
<span class="lineNumber">7</span>InterfaceAlias         : WLAN
<span class="lineNumber">8</span>SourceAddress          : <span class="hljs-number">192.168</span>.<span class="hljs-number">124.11</span>
<span class="lineNumber">9</span>PingSucceeded          : True
<span class="lineNumber">10</span>PingReplyDetails (RTT) : <span class="hljs-number">8</span> ms
<span class="lineNumber">11</span> 
<span class="lineNumber">12</span>➜  Markdown笔记 <span class="hljs-built_in">Set-Alias</span> ping <span class="hljs-built_in">Test-NetConnection</span>
<span class="lineNumber">13</span> 
<span class="lineNumber">14</span>➜  Markdown笔记 ping www.baidu.com
<span class="lineNumber">15</span>ComputerName           : www.baidu.com
<span class="lineNumber">16</span>RemoteAddress          : <span class="hljs-number">14.215</span>.<span class="hljs-number">177.39</span>
<span class="lineNumber">17</span>InterfaceAlias         : WLAN
<span class="lineNumber">18</span>SourceAddress          : <span class="hljs-number">192.168</span>.<span class="hljs-number">124.11</span>
<span class="lineNumber">19</span>PingSucceeded          : True</code></pre> 

<p>但是,不同的终端属于不同的<code>session</code>,你可以在当前终端设置<code>alias</code>,此时其他终端并不会生效.并且,本终端设置的<code>alias</code>会重写默认存在的命令,如上所述,我重写了<code>ping</code>命令.本来<code>ping</code>命令是这样的:</p>
<pre><code class="hljs language-powershell"><span class="lineNumber">1</span>➜  ~ ping www.baidu.com
<span class="lineNumber">2</span> 
<span class="lineNumber">3</span>正在 Ping www.a.shifen.com [<span class="hljs-number">14.215</span><span class="hljs-type">.177.39</span>] 具有 <span class="hljs-number">32</span> 字节的数据:
<span class="lineNumber">4</span>来自 <span class="hljs-number">14.215</span>.<span class="hljs-number">177.39</span> 的回复: 字节=<span class="hljs-number">32</span> 时间=<span class="hljs-number">8</span>ms TTL=<span class="hljs-number">55</span>
<span class="lineNumber">5</span>来自 <span class="hljs-number">14.215</span>.<span class="hljs-number">177.39</span> 的回复: 字节=<span class="hljs-number">32</span> 时间=<span class="hljs-number">8</span>ms TTL=<span class="hljs-number">55</span>
<span class="lineNumber">6</span>来自 <span class="hljs-number">14.215</span>.<span class="hljs-number">177.39</span> 的回复: 字节=<span class="hljs-number">32</span> 时间=<span class="hljs-number">9</span>ms TTL=<span class="hljs-number">55</span>
<span class="lineNumber">7</span>来自 <span class="hljs-number">14.215</span>.<span class="hljs-number">177.39</span> 的回复: 字节=<span class="hljs-number">32</span> 时间=<span class="hljs-number">8</span>ms TTL=<span class="hljs-number">55</span>
<span class="lineNumber">8</span> 
<span class="lineNumber">9</span><span class="hljs-number">14.215</span>.<span class="hljs-number">177.39</span> 的 Ping 统计信息:
<span class="lineNumber">10</span>    数据包: 已发送 = <span class="hljs-number">4</span>，已接收 = <span class="hljs-number">4</span>，丢失 = <span class="hljs-number">0</span> (<span class="hljs-number">0</span>% 丢失)，
<span class="lineNumber">11</span>往返行程的估计时间(以毫秒为单位):
<span class="lineNumber">12</span>    最短 = <span class="hljs-number">8</span>ms，最长 = <span class="hljs-number">9</span>ms，平均 = <span class="hljs-number">8</span>ms</code></pre> 

<h3>1.3 管道</h3>
<p>管道符<code>|</code>放在一条命令的末尾,可以将命令的返回值传递到下一个命令上去,并且作为下一条命令的<code>最后一个参数</code>使用.</p>
<pre><code class="hljs language-powershell"><span class="lineNumber">1</span><span class="hljs-built_in">Get-ChildItem</span> | <span class="hljs-built_in">Select-Object</span> Name
<span class="lineNumber">2</span><span class="hljs-comment">#This may be shortened to:</span>
<span class="lineNumber">3</span><span class="hljs-built_in">gci</span> | <span class="hljs-built_in">Select</span> Name
<span class="lineNumber">4</span> 
<span class="lineNumber">5</span><span class="hljs-comment"># gci就是命令的alias</span>
<span class="lineNumber">6</span> 
<span class="lineNumber">7</span><span class="hljs-built_in">Get-ChildItem</span> | <span class="hljs-built_in">ForEach-Object</span> {
<span class="lineNumber">8</span> <span class="hljs-built_in">Copy-Item</span> <span class="hljs-literal">-Path</span> <span class="hljs-variable">$_</span>.FullName <span class="hljs-literal">-destination</span> C:\NewDirectory\
<span class="lineNumber">9</span>}
<span class="lineNumber">10</span><span class="hljs-comment">#This may be shortened to:</span>
<span class="lineNumber">11</span><span class="hljs-built_in">gci</span> | % { <span class="hljs-built_in">Copy</span> <span class="hljs-variable">$_</span>.FullName C:\NewDirectory\ }</code></pre> 

<h3>1.4 使用<code>.net</code>库的方法</h3>
<p>powershell天生支持<code>.net</code>的各种方法.毕竟是微软一家子的成员.例如:</p>
<pre><code class="hljs language-powershell"><span class="lineNumber">1</span><span class="hljs-comment">#calling Path.GetFileName()</span>
<span class="lineNumber">2</span>C:\> [<span class="hljs-type">System.IO.Path</span>]::GetFileName(<span class="hljs-string">'C:\Windows\explorer.exe'</span>)
<span class="lineNumber">3</span>explorer.exe</code></pre> 

<p>如果你熟悉<code>.net</code> 的话,使用它的库函数就能如虎添翼事半功倍.</p>
<p>使用静态方法可以很直接,但是如果有些方法不是静态方法,则需要对<code>class</code>进行实例化.举例:</p>
<pre><code class="hljs language-powershell"><span class="lineNumber">1</span>➜  Markdown笔记 <span class="hljs-variable">$object</span> = [<span class="hljs-type">System.DateTime</span>]::now
<span class="lineNumber">2</span>➜  Markdown笔记 <span class="hljs-variable">$object</span>.AddHours(<span class="hljs-number">1</span>)
<span class="lineNumber">3</span><span class="hljs-number">2020</span>年<span class="hljs-number">8</span>月<span class="hljs-number">3</span>日 <span class="hljs-number">3</span>:<span class="hljs-number">00</span>:<span class="hljs-number">07</span></code></pre> 

<p>直接就输出一个修改过的时间结果.</p>
<h3>1.5 安装或者设置</h3>
<p>现在默认windows7以上自带<code>powershell</code>,但是在其他平台,则需要手动安装,例如支持在Ubuntu上安装<code>powershell v6</code>.</p>
<p>powershell脚本的注释使用<code>#</code>.或者长注释使用<code>&#x3C;# comment #></code>内部添加注释,支持换行.</p>
<h3>1.6 简述创建对象</h3>
<p>powershell以管道传递对象,对象在powershell中具有独特的地位.举个例子.</p>
<pre><code class="hljs language-powershell"><span class="lineNumber">1</span><span class="hljs-comment"># 创建一个时间对象</span>
<span class="lineNumber">2</span><span class="hljs-variable">$var</span> = <span class="hljs-built_in">new-object</span> system<span class="hljs-literal">-datetime</span>
<span class="lineNumber">3</span><span class="hljs-comment"># 创建一个流对象</span>
<span class="lineNumber">4</span><span class="hljs-variable">$sr</span> = <span class="hljs-built_in">new-object</span> system.io.streamreader <span class="hljs-literal">-argumentList</span> <span class="hljs-string">"file stream"</span>
<span class="lineNumber">5</span> 
<span class="lineNumber">6</span><span class="hljs-comment"># 创建一个复杂对象</span>
<span class="lineNumber">7</span><span class="hljs-variable">$newObj</span> = [<span class="hljs-type">PScustomObject</span>]<span class="hljs-selector-tag">@</span>{
<span class="lineNumber">8</span>	ComputerName = <span class="hljs-string">'server1'</span>,
<span class="lineNumber">9</span>	Env = <span class="hljs-string">'Production'</span>
<span class="lineNumber">10</span>}
<span class="lineNumber">11</span> 
<span class="lineNumber">12</span><span class="hljs-comment"># 创建一个ie浏览器对象</span>
<span class="lineNumber">13</span><span class="hljs-variable">$IE1</span> = <span class="hljs-built_in">New-Object</span> <span class="hljs-literal">-COMObject</span> InternetExplorer.Application <span class="hljs-literal">-Property</span> <span class="hljs-selector-tag">@</span>{Navigate2=<span class="hljs-string">"www.microsoft.com"</span>; Visible = <span class="hljs-variable">$True</span>}
<span class="lineNumber">14</span> 
<span class="lineNumber">15</span><span class="hljs-comment"># The following command gets the same results as the example above.</span>
<span class="lineNumber">16</span><span class="hljs-variable">$IE2</span> = <span class="hljs-built_in">New-Object</span> <span class="hljs-literal">-COMObject</span> InternetExplorer.Application`
<span class="lineNumber">17</span><span class="hljs-variable">$IE2</span>.Navigate2(<span class="hljs-string">"www.microsoft.com"</span>)`
<span class="lineNumber">18</span><span class="hljs-variable">$IE2</span>.Visible = <span class="hljs-variable">$True</span>`</code></pre> 

<p>上述可以看出创建对象的时候可以设置一些属性,或者创建基础实例之后再设置属性.所有的对象都可以通过管道进行传输.对象的集合在导入和导出特定的格式,例如csv或者xml的时候非常有效,例如命令<code>export-csv</code>的每一行都是一个对象.</p>
<h2>chapter2: variable in powershell</h2>
<blockquote>
<p>变量用于保存数据,以便于后续使用.</p>
</blockquote>
<h3>2.1 简单变量和数组</h3>
<pre><code class="hljs language-powershell"><span class="lineNumber">1</span><span class="hljs-variable">$name</span> = <span class="hljs-string">"root"</span>
<span class="lineNumber">2</span><span class="hljs-variable">$numArray</span> = <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>
<span class="lineNumber">3</span><span class="hljs-variable">$newArray</span> = <span class="hljs-number">1</span>,<span class="hljs-string">"2"</span> <span class="hljs-comment"># 不限类型,比较灵活</span>
<span class="lineNumber">4</span><span class="hljs-variable">$numArray</span> = <span class="hljs-variable">$numArray</span> +<span class="hljs-number">5</span>
<span class="lineNumber">5</span><span class="hljs-variable">$newArray</span> = <span class="hljs-variable">$newAarray</span> + <span class="hljs-variable">$numArray</span></code></pre> 

<h3>2.2 拆分变量为数组</h3>
<pre><code class="hljs language-powershell"><span class="lineNumber">1</span><span class="hljs-variable">$input</span>=<span class="hljs-string">"foo.bar.baz"</span>
<span class="lineNumber">2</span><span class="hljs-variable">$parts</span>=<span class="hljs-variable">$input</span>.Split(<span class="hljs-string">"."</span>)
<span class="lineNumber">3</span><span class="hljs-variable">$foo</span>=<span class="hljs-variable">$parts</span>[<span class="hljs-number">0</span>]
<span class="lineNumber">4</span><span class="hljs-variable">$bar</span>=<span class="hljs-variable">$parts</span>[<span class="hljs-number">1</span>]
<span class="lineNumber">5</span><span class="hljs-variable">$baz</span>=<span class="hljs-variable">$parts</span>[<span class="hljs-number">2</span>]
<span class="lineNumber">6</span><span class="hljs-comment">#You can simply do this:</span>
<span class="lineNumber">7</span><span class="hljs-variable">$foo</span>,<span class="hljs-variable">$bar</span>,<span class="hljs-variable">$baz</span>=<span class="hljs-variable">$input</span>.Split(<span class="hljs-string">"."</span>)</code></pre> 

<p>灵活处理字符串和数组.类似<code>js</code>,也可以根据变量的数量去分配.</p>
<pre><code class="hljs language-powershell"><span class="lineNumber">1</span><span class="hljs-variable">$foo</span>, <span class="hljs-variable">$_</span> = <span class="hljs-variable">$input</span>.Split(<span class="hljs-string">"."</span>)
<span class="lineNumber">2</span><span class="hljs-comment"># foo则保存首个拆分的值,_保存剩下的数组.</span></code></pre> 

<h3>2.3 Scope</h3>
<p>作用域范围跟分为局部和全局,函数内部只在内部有效,支持闭包.如果你想要指定外部的变量,以便于和函数内部同名变量区分.则可以使用如下方式:</p>
<p><code>$local:foo</code> 和 <code>$global:foo</code>,如果存在多层嵌套,则<code>global</code>为最外层.</p>
<h3>2.4 移除变量</h3>
<pre><code class="hljs language-powershell"><span class="lineNumber">1</span><span class="hljs-comment"># 需要指定类型为 Variable,再指定变量名</span>
<span class="lineNumber">2</span><span class="hljs-built_in">Remove-Item</span> Variable:\foo</code></pre> 

<p>变量支持像处理文件系统项目的大多数的<code>*-item</code>命令进行处理.</p>
<p>更显式的删除变量,可以使用<code>remove-variable</code>命令.其简写是<code>rv</code>.命令如<code>rv foo</code></p>
<h2>chapter 3: Operators</h2>
<h3>3.1 比较运算符</h3>
<p>类似<code>bash</code>,使用如下方式进行比较,返回<code>true</code>或者<code>false</code>的<code>boolean</code>值.</p>
<pre><code class="hljs language-powershell"><span class="lineNumber">1</span><span class="hljs-number">2</span> <span class="hljs-operator">-eq</span> <span class="hljs-number">2</span>
<span class="lineNumber">2</span><span class="hljs-number">2</span> <span class="hljs-operator">-ne</span> <span class="hljs-number">2</span>
<span class="lineNumber">3</span><span class="hljs-number">2</span> <span class="hljs-operator">-lt</span> <span class="hljs-number">2</span>
<span class="lineNumber">4</span><span class="hljs-number">2</span> <span class="hljs-operator">-gt</span> <span class="hljs-number">2</span>
<span class="lineNumber">5</span><span class="hljs-number">2</span> <span class="hljs-operator">-ge</span> <span class="hljs-number">2</span>
<span class="lineNumber">6</span><span class="hljs-number">2</span> <span class="hljs-operator">-le</span> <span class="hljs-number">2</span>
<span class="lineNumber">7</span><span class="hljs-comment"># 针对大小写是否敏感</span>
<span class="lineNumber">8</span>a <span class="hljs-literal">-eqi</span> A <span class="hljs-comment"># true,字符串不敏感,eqc则敏感</span>
<span class="lineNumber">9</span> 
<span class="lineNumber">10</span><span class="hljs-comment"># 字符串比较</span>
<span class="lineNumber">11</span><span class="hljs-comment"># root at LAPTOP-G92L1V81 in D:\pw7 workstation\git-repos\nextjs_blog\posts on git:master ≣ +0 ~1 -0 ! [1:39:32]</span>
<span class="lineNumber">12</span>➜ <span class="hljs-string">"string"</span> <span class="hljs-operator">-like</span> <span class="hljs-string">"*ing"</span>
<span class="lineNumber">13</span>True
<span class="lineNumber">14</span><span class="hljs-comment"># root at LAPTOP-G92L1V81 in D:\pw7 workstation\git-repos\nextjs_blog\posts on git:master ≣ +0 ~1 -0 ! [1:40:00]</span>
<span class="lineNumber">15</span>➜ <span class="hljs-string">"string"</span> <span class="hljs-operator">-like</span> <span class="hljs-string">"ing"</span>
<span class="lineNumber">16</span>False
<span class="lineNumber">17</span> 
<span class="lineNumber">18</span><span class="hljs-comment"># 加not取反</span>
<span class="lineNumber">19</span>➜ <span class="hljs-string">"string"</span> <span class="hljs-operator">-notlike</span> <span class="hljs-string">"ing"</span>
<span class="lineNumber">20</span>True
<span class="lineNumber">21</span> 
<span class="lineNumber">22</span><span class="hljs-comment"># 支持正则表达式</span>
<span class="lineNumber">23</span>➜ <span class="hljs-string">"string"</span> <span class="hljs-operator">-match</span> <span class="hljs-string">"ing"</span>
<span class="lineNumber">24</span>True
<span class="lineNumber">25</span><span class="hljs-comment"># root at LAPTOP-G92L1V81 in D:\pw7 workstation\git-repos\nextjs_blog\posts on git:master ≣ +0 ~1 -0 ! [1:41:15]</span>
<span class="lineNumber">26</span>➜ <span class="hljs-string">"string"</span> <span class="hljs-operator">-match</span> <span class="hljs-string">"inge"</span>
<span class="lineNumber">27</span>False
<span class="lineNumber">28</span><span class="hljs-comment"># root at LAPTOP-G92L1V81 in D:\pw7 workstation\git-repos\nextjs_blog\posts on git:master ≣ +0 ~1 -0 ! [1:41:22]</span>
<span class="lineNumber">29</span>➜ <span class="hljs-string">"string"</span> <span class="hljs-operator">-match</span> <span class="hljs-string">"ing&#x26;"</span>
<span class="lineNumber">30</span>False
<span class="lineNumber">31</span><span class="hljs-comment"># root at LAPTOP-G92L1V81 in D:\pw7 workstation\git-repos\nextjs_blog\posts on git:master ≣ +0 ~1 -0 ! [1:41:33]</span>
<span class="lineNumber">32</span>➜ <span class="hljs-string">"string"</span> <span class="hljs-operator">-match</span> <span class="hljs-string">"ing<span class="hljs-variable">$</span>"</span>
<span class="lineNumber">33</span>True
<span class="lineNumber">34</span> 
<span class="lineNumber">35</span><span class="hljs-comment"># 集合数据比较</span>
<span class="lineNumber">36</span> 
<span class="lineNumber">37</span><span class="hljs-comment"># root at LAPTOP-G92L1V81 in D:\pw7 workstation\git-repos\nextjs_blog\posts on git:master ≣ +0 ~1 -0 ! [1:41:37]</span>
<span class="lineNumber">38</span>➜ <span class="hljs-string">"12"</span>,<span class="hljs-string">"abc"</span> <span class="hljs-operator">-contains</span> <span class="hljs-string">"1"</span>
<span class="lineNumber">39</span>False
<span class="lineNumber">40</span><span class="hljs-comment"># root at LAPTOP-G92L1V81 in D:\pw7 workstation\git-repos\nextjs_blog\posts on git:master ≣ +0 ~1 -0 ! [1:44:14]</span>
<span class="lineNumber">41</span>➜ <span class="hljs-string">"12"</span>,<span class="hljs-string">"abc"</span> <span class="hljs-operator">-contains</span> <span class="hljs-string">"12"</span>
<span class="lineNumber">42</span>True
<span class="lineNumber">43</span> 
<span class="lineNumber">44</span>➜ <span class="hljs-string">"12"</span> <span class="hljs-operator">-in</span> <span class="hljs-string">"aaa"</span>,<span class="hljs-string">"12"</span>
<span class="lineNumber">45</span>True</code></pre> 

<h3>3.2 算数运算</h3>
<pre><code class="hljs language-powershell"><span class="lineNumber">1</span><span class="hljs-number">1</span>+<span class="hljs-number">2</span>	<span class="hljs-comment"># Addition</span>
<span class="lineNumber">2</span><span class="hljs-number">1</span><span class="hljs-literal">-2</span>	<span class="hljs-comment"># Subtraction</span>
<span class="lineNumber">3</span><span class="hljs-literal">-1</span>	<span class="hljs-comment"># Set negative value</span>
<span class="lineNumber">4</span><span class="hljs-number">1</span>*<span class="hljs-number">2</span>	<span class="hljs-comment"># Multiplication</span>
<span class="lineNumber">5</span><span class="hljs-number">1</span>/<span class="hljs-number">2</span>	<span class="hljs-comment"># Division</span>
<span class="lineNumber">6</span><span class="hljs-number">1</span>%<span class="hljs-number">2</span>	<span class="hljs-comment"># Modulus</span>
<span class="lineNumber">7</span><span class="hljs-number">100</span> <span class="hljs-operator">-shl</span> <span class="hljs-number">2</span> <span class="hljs-comment"># 按位左移</span>
<span class="lineNumber">8</span><span class="hljs-number">100</span> <span class="hljs-operator">-shr</span> <span class="hljs-number">2</span> <span class="hljs-comment"># 按位右移</span>
<span class="lineNumber">9</span> 
<span class="lineNumber">10</span><span class="hljs-comment"># 变量计算</span>
<span class="lineNumber">11</span><span class="hljs-variable">$var</span> = <span class="hljs-number">1</span>
<span class="lineNumber">12</span><span class="hljs-variable">$var</span> += <span class="hljs-number">2</span>
<span class="lineNumber">13</span><span class="hljs-variable">$var</span>++
<span class="lineNumber">14</span><span class="hljs-variable">$var</span> += <span class="hljs-string">"2"</span> <span class="hljs-comment"># 也支持,自动类型转换</span></code></pre> 

<h3>3.3 输出重定向操作</h3>
<blockquote>
<p>大神详解:<a href="https://devblogs.microsoft.com/scripting/understanding-streams-redirection-and-write-host-in-powershell/">Understanding Streams, Redirection, and Write-Host in PowerShell | Scripting Blog</a></p>
</blockquote>
<p>执行命令或者程序,将产生不同类型的输出信息流.</p>
<p><img src="https://devblogs.microsoft.com/wp-content/uploads/sites/29/2019/02/2570.1.png" alt=""></p>
<p>顺利执行将产生success的输出流,举个例子:</p>
<pre><code class="hljs language-powershell"><span class="lineNumber">1</span>cmdlet > file <span class="hljs-comment"># 发送success输出流重写file的内容</span>
<span class="lineNumber">2</span>cmdlet >> file <span class="hljs-comment"># 追加success输出流到file的文件末尾</span>
<span class="lineNumber">3</span>cmdlet <span class="hljs-number">1</span>>&#x26;<span class="hljs-number">2</span> <span class="hljs-comment"># 1代表success状态的输出流,此时指的是将success(1)和error(2)的输出重定向到error流中去</span>
<span class="lineNumber">4</span> 
<span class="lineNumber">5</span>cmdlet <span class="hljs-number">2</span>> file <span class="hljs-comment"># error(2) 输出流</span>
<span class="lineNumber">6</span>cmdlet <span class="hljs-number">3</span>> file <span class="hljs-comment"># powershell v3+支持的warning数据流</span>
<span class="lineNumber">7</span>cmdlet <span class="hljs-number">4</span>> file <span class="hljs-comment"># powershell v3+支持的verbose输出流,详细消息流通常用于提供命令处理的相关信息,便于调试</span>
<span class="lineNumber">8</span>cmdlet <span class="hljs-number">5</span>> file <span class="hljs-comment"># Debug</span>
<span class="lineNumber">9</span>cmdlet <span class="hljs-number">6</span>> file <span class="hljs-comment"># information level</span></code></pre> 

<p>不同的流是平行的,在管道之间传递对象,我们并不希望接受cmdlet各种类型的流式数据.且管道符默认接收了<code>success</code>级别的信息.其他的流的数据发往了其他的接收处.</p>
<blockquote>
<p>Windows PowerShell inventor, Jeffrey Snover, says that <a href="http://www.jsnover.com/blog/2013/12/07/write-host-considered-harmful/">Write-Host is harmful</a></p>
</blockquote>
<p><strong>Write-Host is not written to any stream</strong>.<code>write-host</code>不会污染输出流,且<code>不向任何流进行输入</code>.单纯向屏幕输出.</p>
<p>也就是说你无法将<code>write-host</code>的message定向到其他流,也没法分配给变量.</p>
<p>还可以看看这里:<a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_redirection?view=powershell-7">about_Redirection - PowerShell | Microsoft Docs</a></p>
<p>另外举个例子:</p>
<pre><code class="hljs language-powershell"><span class="lineNumber">1</span><span class="hljs-comment"># 同时ls查看两个目录,如下命令可以将错误信息重定向转移走,输入到z文件,而不会只是将success的ls d:结果输出z</span>
<span class="lineNumber">2</span>▶ <span class="hljs-built_in">ls</span> D:,fake *> z
<span class="lineNumber">3</span> 
<span class="lineNumber">4</span><span class="hljs-comment"># 如果不重定向</span>
<span class="lineNumber">5</span>▶ <span class="hljs-built_in">ls</span> D:,fake > z
<span class="lineNumber">6</span><span class="hljs-built_in">Get-ChildItem</span>: Cannot find path <span class="hljs-string">'C:\Users\root\fake'</span> because it does not exist.
<span class="lineNumber">7</span>~ ⨯
<span class="lineNumber">8</span>▶ <span class="hljs-built_in">cat</span> z
<span class="lineNumber">9</span> 
<span class="lineNumber">10</span>
<span class="lineNumber">11</span>    Directory: D:\pw7 workstation\git<span class="hljs-literal">-repos</span>\nextjs_blog\posts
<span class="lineNumber">12</span><span class="hljs-comment"># 则z保存了success的信息</span></code></pre> 

<p>至于,将<code>success</code>消息重定向到<code>error流</code>的操作,终端提示错误,跟书本不符.不过不会真有人想要做这种事吧.</p>
<p>另外,我用过几次将没必要的错误信息流重定向到<code>$null</code>中去.或者将没必要的所有流都扔掉:</p>
<pre><code class="hljs language-powershell"><span class="lineNumber">1</span>cmdlet *><span class="hljs-variable">$null</span></code></pre> 

<h3>3.4 混合操作类型</h3>
<p>举例如下:</p>
<pre><code class="hljs language-powershell"><span class="lineNumber">1</span>▶ <span class="hljs-string">"2"</span>+<span class="hljs-number">2</span>
<span class="lineNumber">2</span><span class="hljs-number">22</span>
<span class="lineNumber">3</span>~
<span class="lineNumber">4</span>▶ <span class="hljs-number">2</span>+<span class="hljs-string">"22"</span>
<span class="lineNumber">5</span><span class="hljs-number">24</span>
<span class="lineNumber">6</span>~
<span class="lineNumber">7</span>➜ <span class="hljs-string">"2"</span> * <span class="hljs-number">2</span>
<span class="lineNumber">8</span><span class="hljs-number">22</span>
<span class="lineNumber">9</span>➜ <span class="hljs-number">2</span> * <span class="hljs-string">"2"</span>
<span class="lineNumber">10</span><span class="hljs-number">4</span>
<span class="lineNumber">11</span>➜ <span class="hljs-variable">$a</span> = <span class="hljs-built_in">Read-Host</span>
<span class="lineNumber">12</span><span class="hljs-number">33</span>
<span class="lineNumber">13</span>➜ <span class="hljs-variable">$a</span> <span class="hljs-operator">-gt</span> <span class="hljs-number">5</span>
<span class="lineNumber">14</span>False
<span class="lineNumber">15</span>➜ <span class="hljs-number">5</span> <span class="hljs-operator">-gt</span> <span class="hljs-variable">$a</span>
<span class="lineNumber">16</span>False</code></pre> 

<p>左边的数据类型决定了整体的计算和数据转换方式.</p>
<h3>3.5 逻辑操作和字符串变换操作</h3>
<p>举例:</p>
<pre><code class="hljs language-powershell"><span class="lineNumber">1</span><span class="hljs-operator">-and</span> <span class="hljs-comment"># 与</span>
<span class="lineNumber">2</span><span class="hljs-operator">-or</span> <span class="hljs-comment"># 或</span>
<span class="lineNumber">3</span><span class="hljs-operator">-xor</span> <span class="hljs-comment"># 异或</span>
<span class="lineNumber">4</span><span class="hljs-operator">-not</span> <span class="hljs-comment"># not</span>
<span class="lineNumber">5</span>! <span class="hljs-comment"># not</span>
<span class="lineNumber">6</span> 
<span class="lineNumber">7</span><span class="hljs-comment"># 常见替换</span>
<span class="lineNumber">8</span>➜ <span class="hljs-string">"just a demo"</span> <span class="hljs-operator">-replace</span> <span class="hljs-string">"demo"</span>,<span class="hljs-string">"test"</span>
<span class="lineNumber">9</span>just a test
<span class="lineNumber">10</span> 
<span class="lineNumber">11</span><span class="hljs-comment"># 正则表达式单引号替换</span>
<span class="lineNumber">12</span>➜ <span class="hljs-string">"root@gmail.com"</span> <span class="hljs-operator">-replace</span> <span class="hljs-string">'^[\w]+@(.+)'</span>,<span class="hljs-string">'$1'</span>
<span class="lineNumber">13</span>gmail.com
<span class="lineNumber">14</span> 
<span class="lineNumber">15</span><span class="hljs-comment"># 拆分数组</span>
<span class="lineNumber">16</span>➜ <span class="hljs-string">"root@gmail.com"</span> <span class="hljs-operator">-split</span> <span class="hljs-string">"@"</span>
<span class="lineNumber">17</span>root
<span class="lineNumber">18</span>gmail.com
<span class="lineNumber">19</span> 
<span class="lineNumber">20</span><span class="hljs-comment"># join数组</span>
<span class="lineNumber">21</span>➜ <span class="hljs-string">"1"</span>,<span class="hljs-string">"1"</span>,<span class="hljs-string">"0"</span> <span class="hljs-operator">-join</span> <span class="hljs-string">":"</span>
<span class="lineNumber">22</span><span class="hljs-number">1</span>:<span class="hljs-number">1</span>:<span class="hljs-number">0</span></code></pre> 

<h2>Chapter 4: Special Operators</h2>
<h3>4.1 数组表达运算符</h3>
<p>通过一个表达式返回一个数组:</p>
<pre><code class="hljs language-powershell"><span class="lineNumber">1</span>➜  posts git:(master) <span class="hljs-selector-tag">@</span>(<span class="hljs-built_in">Get-ChildItem</span> C:\Windows\System32\ntdll.dll)
<span class="lineNumber">2</span> 
<span class="lineNumber">3</span>
<span class="lineNumber">4</span>    Directory: C:\Windows\System32
<span class="lineNumber">5</span> 
<span class="lineNumber">6</span>Mode                 LastWriteTime         Length Name
<span class="lineNumber">7</span>----                 -------------         ------ ----
<span class="lineNumber">8</span><span class="hljs-literal">-a</span>---           <span class="hljs-number">2020</span>/<span class="hljs-number">7</span>/<span class="hljs-number">17</span>    <span class="hljs-number">20</span>:<span class="hljs-number">10</span>        <span class="hljs-number">1999968</span> ntdll.dll
<span class="lineNumber">9</span> 
<span class="lineNumber">10</span>➜  posts git:(master) <span class="hljs-selector-tag">@</span>(<span class="hljs-built_in">Get-ChildItem</span> C:\Windows\System32\ntdll.dll)[<span class="hljs-number">0</span>]
<span class="lineNumber">11</span> 
<span class="lineNumber">12</span>
<span class="lineNumber">13</span>    Directory: C:\Windows\System32
<span class="lineNumber">14</span> 
<span class="lineNumber">15</span>Mode                 LastWriteTime         Length Name
<span class="lineNumber">16</span>----                 -------------         ------ ----
<span class="lineNumber">17</span><span class="hljs-literal">-a</span>---           <span class="hljs-number">2020</span>/<span class="hljs-number">7</span>/<span class="hljs-number">17</span>    <span class="hljs-number">20</span>:<span class="hljs-number">10</span>        <span class="hljs-number">1999968</span> ntdll.dll
<span class="lineNumber">18</span> 
<span class="lineNumber">19</span>➜  posts git:(master) <span class="hljs-selector-tag">@</span>(<span class="hljs-built_in">Get-ChildItem</span> C:\Windows\System32\ntdll.dll)[<span class="hljs-number">1</span>]
<span class="lineNumber">20</span>➜  posts git:(master)</code></pre> 

<p>如上所述,<code>@()</code>内部的表达式处理返回值将得到一个数组.</p>
<h3>4.2 调用运算符</h3>
<pre><code class="hljs language-powershell"><span class="lineNumber">1</span><span class="hljs-variable">$command</span> = <span class="hljs-string">'ls'</span>
<span class="lineNumber">2</span>&#x26;<span class="hljs-variable">$command</span> <span class="hljs-comment"># 等于直接调用字符串的内容,视为命令并执行</span></code></pre> 

<h3>4.3 点源操作(dot sourcing operator)</h3>
<p><code>. $profile</code>是我很常用的一个命令,因为我经常修改预加载的配置文件<code>$profile</code>.这个变量指向一个<code>.ps1</code>文件,每个console打开的时候都会<code>run</code>这个文件.因此,可以在这里面设置一下alias或者function.</p>
<p>当我们在当前terminal下使用<code>. xxx.ps1</code>命令执行此脚本的时候,即将此脚本的执行环境范围设置为当前<code>terminal session</code>.</p>
<p>回到<code>$profile</code>的例子,我修改了这个脚本,并且在当前<code>terminal</code>执行了<code>. $profile</code>,则此脚本内的函数即加载到我的<code>terminal session</code>内了.我可以轻松调用此脚本内的函数处理我的事务.</p>
<h2>Chapter 5: Basic set Operations</h2>
<h3>5.1 对象选择</h3>
<p>使用条件表达式<code>where-object</code> 过滤枚举对象,其常用alias是<code>where</code>和<code>?</code>.</p>
<pre><code class="hljs language-powershell"><span class="lineNumber">1</span>➜  ~ <span class="hljs-variable">$names</span>= <span class="hljs-selector-tag">@</span>(<span class="hljs-string">"Aaron"</span>,<span class="hljs-string">"Albert"</span>,<span class="hljs-string">"Alphonse"</span>,<span class="hljs-string">"Bernie"</span>,<span class="hljs-string">"Charlie"</span>,<span class="hljs-string">"Danny"</span>,<span class="hljs-string">"Ernie"</span>,<span class="hljs-string">"Frank"</span>)
<span class="lineNumber">2</span>➜  ~ <span class="hljs-variable">$name</span> | <span class="hljs-built_in">Where-Object</span> {<span class="hljs-variable">$_</span> <span class="hljs-operator">-like</span> <span class="hljs-string">"*yi"</span>}
<span class="lineNumber">3</span>youyi
<span class="lineNumber">4</span>➜  ~ <span class="hljs-variable">$name</span> | <span class="hljs-built_in">Where</span> {<span class="hljs-variable">$_</span> <span class="hljs-operator">-like</span> <span class="hljs-string">"*yi"</span>}
<span class="lineNumber">5</span>youyi
<span class="lineNumber">6</span>➜  ~ <span class="hljs-variable">$name</span> | ? {<span class="hljs-variable">$_</span> <span class="hljs-operator">-like</span> <span class="hljs-string">"*yi"</span>}
<span class="lineNumber">7</span>youyi</code></pre> 

<h3>5.2 对象排序</h3>
<p>对可迭代对象进行升序和降序排序:</p>
<pre><code class="hljs language-powershell"><span class="lineNumber">1</span>➜  ~ <span class="hljs-variable">$names</span>= <span class="hljs-selector-tag">@</span>(<span class="hljs-string">"Aaron"</span>,<span class="hljs-string">"Albert"</span>,<span class="hljs-string">"Alphonse"</span>,<span class="hljs-string">"Bernie"</span>,<span class="hljs-string">"Charlie"</span>,<span class="hljs-string">"Danny"</span>,<span class="hljs-string">"Ernie"</span>,<span class="hljs-string">"Frank"</span>)
<span class="lineNumber">2</span>➜  ~ <span class="hljs-variable">$names</span> | <span class="hljs-built_in">sort</span>
<span class="lineNumber">3</span>Aaron
<span class="lineNumber">4</span>Albert
<span class="lineNumber">5</span>Alphonse
<span class="lineNumber">6</span>Bernie
<span class="lineNumber">7</span>Charlie
<span class="lineNumber">8</span>Danny
<span class="lineNumber">9</span>Ernie
<span class="lineNumber">10</span>Frank
<span class="lineNumber">11</span>➜  ~ <span class="hljs-variable">$names</span> | <span class="hljs-built_in">Sort-Object</span> <span class="hljs-literal">-Descending</span>
<span class="lineNumber">12</span>Frank
<span class="lineNumber">13</span>Ernie
<span class="lineNumber">14</span>Danny
<span class="lineNumber">15</span>Charlie
<span class="lineNumber">16</span>Bernie
<span class="lineNumber">17</span>Alphonse
<span class="lineNumber">18</span>Albert
<span class="lineNumber">19</span>Aaron
<span class="lineNumber">20</span> 
<span class="lineNumber">21</span><span class="hljs-comment"># 指定属性</span>
<span class="lineNumber">22</span>➜  ~ <span class="hljs-variable">$names</span> | <span class="hljs-built_in">Sort-Object</span> <span class="hljs-literal">-Top</span> <span class="hljs-number">3</span> <span class="hljs-literal">-Property</span> Length
<span class="lineNumber">23</span>Aaron
<span class="lineNumber">24</span>Danny
<span class="lineNumber">25</span>Ernie
<span class="lineNumber">26</span>➜  ~ <span class="hljs-variable">$names</span> | <span class="hljs-built_in">Sort-Object</span> {<span class="hljs-variable">$_</span>.length} <span class="hljs-literal">-Top</span> <span class="hljs-number">3</span>
<span class="lineNumber">27</span>Aaron
<span class="lineNumber">28</span>Danny
<span class="lineNumber">29</span>Ernie</code></pre> 

<h3>5.3 分组排序</h3>
<p>可以通过设置表达式,实现分组的排序.</p>
<pre><code class="hljs language-powershell"><span class="lineNumber">1</span>➜  ~ <span class="hljs-variable">$names</span> | <span class="hljs-built_in">Group-Object</span> <span class="hljs-literal">-Property</span> length <span class="hljs-comment"># group-object alias is group</span>
<span class="lineNumber">2</span> 
<span class="lineNumber">3</span>Count Name                      <span class="hljs-built_in">Group</span>
<span class="lineNumber">4</span>----- ----                      -----
<span class="lineNumber">5</span>    <span class="hljs-number">4</span> <span class="hljs-number">5</span>                         {Aaron, Danny, Ernie, Frank}
<span class="lineNumber">6</span>    <span class="hljs-number">2</span> <span class="hljs-number">6</span>                         {Albert, Bernie}
<span class="lineNumber">7</span>    <span class="hljs-number">1</span> <span class="hljs-number">7</span>                         {Charlie}
<span class="lineNumber">8</span>    <span class="hljs-number">1</span> <span class="hljs-number">8</span>                         {Alphonse}</code></pre> 

<h3>5.4 对象投影</h3>
<p>这个小节标题让我想起当初上SQL的课的时候了.投影一个可迭代对象的部分item,可以对单独的对象进行展开操作.获取自己想要的部分数据.</p>
<pre><code class="hljs language-powershell"><span class="lineNumber">1</span>➜  ~ <span class="hljs-variable">$dir</span> = <span class="hljs-built_in">ls</span>
<span class="lineNumber">2</span>➜  ~ <span class="hljs-variable">$dir</span> | <span class="hljs-built_in">select</span> name, FullName, LastAccessTime
<span class="lineNumber">3</span> 
<span class="lineNumber">4</span>Name                     FullName                               Last
<span class="lineNumber">5</span>                                                                Acce
<span class="lineNumber">6</span>                                                                ssTi
<span class="lineNumber">7</span>                                                                me
<span class="lineNumber">8</span>----                     --------                               ----
<span class="lineNumber">9</span>.atom                    C:\Users\root\.atom                    <span class="hljs-number">202</span>…
<span class="lineNumber">10</span>.config                  C:\Users\root\.config                  <span class="hljs-number">202</span>…
<span class="lineNumber">11</span>.ssh                     C:\Users\root\.ssh                     <span class="hljs-number">202</span>…
<span class="lineNumber">12</span>.vscode                  C:\Users\root\.vscode                  <span class="hljs-number">202</span>…
<span class="lineNumber">13</span><span class="hljs-number">3</span>D Objects               C:\Users\root\<span class="hljs-number">3</span>D Objects               <span class="hljs-number">202</span>…
<span class="lineNumber">14</span>Contacts                 C:\Users\root\Contacts                 <span class="hljs-number">202</span>…
<span class="lineNumber">15</span>Documents                C:\Users\root\Documents                <span class="hljs-number">202</span>…
<span class="lineNumber">16</span>Downloads                C:\Users\root\Downloads                <span class="hljs-number">202</span>…
<span class="lineNumber">17</span>Favorites                C:\Users\root\Favorites                <span class="hljs-number">202</span>…
<span class="lineNumber">18</span>Links                    C:\Users\root\Links                    <span class="hljs-number">202</span>…
<span class="lineNumber">19</span>Music                    C:\Users\root\Music                    <span class="hljs-number">202</span>…
<span class="lineNumber">20</span>OneDrive                 C:\Users\root\OneDrive                 <span class="hljs-number">202</span>…
<span class="lineNumber">21</span>Pictures                 C:\Users\root\Pictures                 <span class="hljs-number">202</span>…
<span class="lineNumber">22</span>Saved Games              C:\Users\root\Saved Games              <span class="hljs-number">202</span>…
<span class="lineNumber">23</span>scoop                    C:\Users\root\scoop                    <span class="hljs-number">202</span>…
<span class="lineNumber">24</span>Searches                 C:\Users\root\Searches                 <span class="hljs-number">202</span>…
<span class="lineNumber">25</span>Videos                   C:\Users\root\Videos                   <span class="hljs-number">202</span>…
<span class="lineNumber">26</span>.bash_history            C:\Users\root\.bash_history            <span class="hljs-number">202</span>…
<span class="lineNumber">27</span>.bash_profile            C:\Users\root\.bash_profile            <span class="hljs-number">202</span>…
<span class="lineNumber">28</span>.bashrc                  C:\Users\root\.bashrc                  <span class="hljs-number">202</span>…
<span class="lineNumber">29</span>.bashrc.swp              C:\Users\root\.bashrc.swp              <span class="hljs-number">202</span>…
<span class="lineNumber">30</span>.gitconfig               C:\Users\root\.gitconfig               <span class="hljs-number">202</span>…
<span class="lineNumber">31</span>.git<span class="hljs-literal">-for</span><span class="hljs-literal">-windows</span><span class="hljs-literal">-updater</span> C:\Users\root\.git<span class="hljs-literal">-for</span><span class="hljs-literal">-windows</span><span class="hljs-literal">-updater</span> <span class="hljs-number">202</span>…
<span class="lineNumber">32</span>.node_repl_history       C:\Users\root\.node_repl_history       <span class="hljs-number">202</span>…
<span class="lineNumber">33</span>.viminfo                 C:\Users\root\.viminfo                 <span class="hljs-number">202</span>…
<span class="lineNumber">34</span>.vuerc                   C:\Users\root\.vuerc                   <span class="hljs-number">202</span>…
<span class="lineNumber">35</span>.yarnrc                  C:\Users\root\.yarnrc                  <span class="hljs-number">202</span>…
<span class="lineNumber">36</span> 
<span class="lineNumber">37</span>➜  ~</code></pre> 

</div></div></div></main><style data-emotion-css="1fic0ux">.css-1fic0ux{border:0;opacity:0.6;border-bottom:0.0625rem solid;width:auto;margin-top:0.5rem;margin-bottom:0.5rem;border-color:inherit;}</style><hr class="css-1fic0ux"/><style data-emotion-css="11i96b0">.css-11i96b0{margin:2rem;text-align:center;}</style><div class="css-11i96b0"><p id="msg">谢谢你能看到这里!<span role="img" aria-label="emoji">🤗</span> 如果你有任何想与我讨论的内容,请给我发邮件.<span role="img" aria-label="emoji">🕊</span></p><br/><a style="text-decoration:none" href="mailto:rivenqinyy@gmail.com"><style data-emotion-css="meafa5">.css-meafa5{display:inline-block;padding-left:0.25rem;padding-right:0.25rem;text-transform:uppercase;font-size:0.75rem;border-radius:0.125rem;font-weight:700;white-space:nowrap;vertical-align:middle;background-color:#c6f6d5;color:#22543d;}</style><div class="css-meafa5">我的邮件</div><span role="img" aria-label="my email">📮</span></a><br/><br/><style data-emotion-css="1fb5c92">.css-1fb5c92{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";color:#4A5568;font-size:.7rem;}</style><p class="css-1fb5c92">妙才 © 2020. All rights reserved.</p></div></div></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"slug":"Powershell随写","contentHtml":"\u003ch2\u003echapter1：getting started with powershell\u003c/h2\u003e\n\u003ch3\u003e1.1 允许在你的机器上运行脚本\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-powershell\"\u003e\u003cspan class=\"lineNumber\"\u003e1\u003c/span\u003e\u003cspan class=\"hljs-comment\"\u003e# 以管理员身份运行,这条命令将修改注册表,注册表中保存了powershell很多默认配置项\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e2\u003c/span\u003e\u003cspan class=\"hljs-built_in\"\u003eSet-ExecutionPolicy\u003c/span\u003e RemoteSigned\u003c/code\u003e\u003c/pre\u003e \n\n\u003cp\u003e将powershell的运行策略修改为运行未签名的脚本运行.或者通过管理员权限打开一个终端,执行脚本的时候指明使用\u003ccode\u003ebypass\u003c/code\u003e策略.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-powershell\"\u003e\u003cspan class=\"lineNumber\"\u003e1\u003c/span\u003epowershell.exe \u003cspan class=\"hljs-literal\"\u003e-ExecutionPolicy\u003c/span\u003e Bypass \u003cspan class=\"hljs-operator\"\u003e-File\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"c:\\MyScript.ps1\"\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e2\u003c/span\u003e\u003cspan class=\"hljs-comment\"\u003e# 或者在此控制台先执行\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e3\u003c/span\u003e\u003cspan class=\"hljs-built_in\"\u003eSet-ExecutionPolicy\u003c/span\u003e Bypass \u003cspan class=\"hljs-keyword\"\u003eProcess\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e \n\n\u003ch3\u003e1.2 alias和简单函数\u003c/h3\u003e\n\u003cp\u003e举个例子,\u003ccode\u003ewrite-output\u003c/code\u003e和\u003ccode\u003ewrite-host\u003c/code\u003e都能接受字符并且输出到屏幕,但是\u003ccode\u003ewrite-output\u003c/code\u003e还能返回输出的值作为结果,这在变量引用和管道传递方面很有用.简单函数不同但是结果相同,这在powershell中非常常见.\u003c/p\u003e\n\u003cp\u003e同一个命令,可以有不同的别名,例如\u003ccode\u003ewrite-output\u003c/code\u003e的\u003ccode\u003ealias\u003c/code\u003e有\u003ccode\u003eecho\u003c/code\u003e和\u003ccode\u003ewrite\u003c/code\u003e.甚至,可以直接用单引号或者双引号括起来直接输出:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-powershell\"\u003e\u003cspan class=\"lineNumber\"\u003e1\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e\"hello world\"\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e2\u003c/span\u003e\u003cspan class=\"hljs-string\"\u003e'hello world'\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e3\u003c/span\u003e \n\u003cspan class=\"lineNumber\"\u003e4\u003c/span\u003e\u003cspan class=\"hljs-comment\"\u003e# alias即别名,一条命令可以有不同的别名,就像人可以有不同的外号,如下举例\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e5\u003c/span\u003e\u003cspan class=\"hljs-built_in\"\u003els\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e6\u003c/span\u003e\u003cspan class=\"hljs-built_in\"\u003edir\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e7\u003c/span\u003e\u003cspan class=\"hljs-comment\"\u003e# 都是get-childitem的alias\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e \n\n\u003cp\u003e这些是系统自带的alias,我们可以自己增加,例如:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-powershell\"\u003e\u003cspan class=\"lineNumber\"\u003e1\u003c/span\u003e\u003cspan class=\"hljs-built_in\"\u003eset-alias\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003e-Name\u003c/span\u003e ping \u003cspan class=\"hljs-literal\"\u003e-value\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003etest-netconnection\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e2\u003c/span\u003e \n\u003cspan class=\"lineNumber\"\u003e3\u003c/span\u003e\u003cspan class=\"hljs-comment\"\u003e# 如下所示\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e4\u003c/span\u003e➜  Markdown笔记 \u003cspan class=\"hljs-built_in\"\u003eTest-NetConnection\u003c/span\u003e www.baidu.com\n\u003cspan class=\"lineNumber\"\u003e5\u003c/span\u003eComputerName           : www.baidu.com\n\u003cspan class=\"lineNumber\"\u003e6\u003c/span\u003eRemoteAddress          : \u003cspan class=\"hljs-number\"\u003e14.215\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e177.39\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e7\u003c/span\u003eInterfaceAlias         : WLAN\n\u003cspan class=\"lineNumber\"\u003e8\u003c/span\u003eSourceAddress          : \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e124.11\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e9\u003c/span\u003ePingSucceeded          : True\n\u003cspan class=\"lineNumber\"\u003e10\u003c/span\u003ePingReplyDetails (RTT) : \u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e ms\n\u003cspan class=\"lineNumber\"\u003e11\u003c/span\u003e \n\u003cspan class=\"lineNumber\"\u003e12\u003c/span\u003e➜  Markdown笔记 \u003cspan class=\"hljs-built_in\"\u003eSet-Alias\u003c/span\u003e ping \u003cspan class=\"hljs-built_in\"\u003eTest-NetConnection\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e13\u003c/span\u003e \n\u003cspan class=\"lineNumber\"\u003e14\u003c/span\u003e➜  Markdown笔记 ping www.baidu.com\n\u003cspan class=\"lineNumber\"\u003e15\u003c/span\u003eComputerName           : www.baidu.com\n\u003cspan class=\"lineNumber\"\u003e16\u003c/span\u003eRemoteAddress          : \u003cspan class=\"hljs-number\"\u003e14.215\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e177.39\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e17\u003c/span\u003eInterfaceAlias         : WLAN\n\u003cspan class=\"lineNumber\"\u003e18\u003c/span\u003eSourceAddress          : \u003cspan class=\"hljs-number\"\u003e192.168\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e124.11\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e19\u003c/span\u003ePingSucceeded          : True\u003c/code\u003e\u003c/pre\u003e \n\n\u003cp\u003e但是,不同的终端属于不同的\u003ccode\u003esession\u003c/code\u003e,你可以在当前终端设置\u003ccode\u003ealias\u003c/code\u003e,此时其他终端并不会生效.并且,本终端设置的\u003ccode\u003ealias\u003c/code\u003e会重写默认存在的命令,如上所述,我重写了\u003ccode\u003eping\u003c/code\u003e命令.本来\u003ccode\u003eping\u003c/code\u003e命令是这样的:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-powershell\"\u003e\u003cspan class=\"lineNumber\"\u003e1\u003c/span\u003e➜  ~ ping www.baidu.com\n\u003cspan class=\"lineNumber\"\u003e2\u003c/span\u003e \n\u003cspan class=\"lineNumber\"\u003e3\u003c/span\u003e正在 Ping www.a.shifen.com [\u003cspan class=\"hljs-number\"\u003e14.215\u003c/span\u003e\u003cspan class=\"hljs-type\"\u003e.177.39\u003c/span\u003e] 具有 \u003cspan class=\"hljs-number\"\u003e32\u003c/span\u003e 字节的数据:\n\u003cspan class=\"lineNumber\"\u003e4\u003c/span\u003e来自 \u003cspan class=\"hljs-number\"\u003e14.215\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e177.39\u003c/span\u003e 的回复: 字节=\u003cspan class=\"hljs-number\"\u003e32\u003c/span\u003e 时间=\u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003ems TTL=\u003cspan class=\"hljs-number\"\u003e55\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e5\u003c/span\u003e来自 \u003cspan class=\"hljs-number\"\u003e14.215\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e177.39\u003c/span\u003e 的回复: 字节=\u003cspan class=\"hljs-number\"\u003e32\u003c/span\u003e 时间=\u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003ems TTL=\u003cspan class=\"hljs-number\"\u003e55\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e6\u003c/span\u003e来自 \u003cspan class=\"hljs-number\"\u003e14.215\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e177.39\u003c/span\u003e 的回复: 字节=\u003cspan class=\"hljs-number\"\u003e32\u003c/span\u003e 时间=\u003cspan class=\"hljs-number\"\u003e9\u003c/span\u003ems TTL=\u003cspan class=\"hljs-number\"\u003e55\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e7\u003c/span\u003e来自 \u003cspan class=\"hljs-number\"\u003e14.215\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e177.39\u003c/span\u003e 的回复: 字节=\u003cspan class=\"hljs-number\"\u003e32\u003c/span\u003e 时间=\u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003ems TTL=\u003cspan class=\"hljs-number\"\u003e55\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e8\u003c/span\u003e \n\u003cspan class=\"lineNumber\"\u003e9\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e14.215\u003c/span\u003e.\u003cspan class=\"hljs-number\"\u003e177.39\u003c/span\u003e 的 Ping 统计信息:\n\u003cspan class=\"lineNumber\"\u003e10\u003c/span\u003e    数据包: 已发送 = \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e，已接收 = \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e，丢失 = \u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e (\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e% 丢失)，\n\u003cspan class=\"lineNumber\"\u003e11\u003c/span\u003e往返行程的估计时间(以毫秒为单位):\n\u003cspan class=\"lineNumber\"\u003e12\u003c/span\u003e    最短 = \u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003ems，最长 = \u003cspan class=\"hljs-number\"\u003e9\u003c/span\u003ems，平均 = \u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003ems\u003c/code\u003e\u003c/pre\u003e \n\n\u003ch3\u003e1.3 管道\u003c/h3\u003e\n\u003cp\u003e管道符\u003ccode\u003e|\u003c/code\u003e放在一条命令的末尾,可以将命令的返回值传递到下一个命令上去,并且作为下一条命令的\u003ccode\u003e最后一个参数\u003c/code\u003e使用.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-powershell\"\u003e\u003cspan class=\"lineNumber\"\u003e1\u003c/span\u003e\u003cspan class=\"hljs-built_in\"\u003eGet-ChildItem\u003c/span\u003e | \u003cspan class=\"hljs-built_in\"\u003eSelect-Object\u003c/span\u003e Name\n\u003cspan class=\"lineNumber\"\u003e2\u003c/span\u003e\u003cspan class=\"hljs-comment\"\u003e#This may be shortened to:\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e3\u003c/span\u003e\u003cspan class=\"hljs-built_in\"\u003egci\u003c/span\u003e | \u003cspan class=\"hljs-built_in\"\u003eSelect\u003c/span\u003e Name\n\u003cspan class=\"lineNumber\"\u003e4\u003c/span\u003e \n\u003cspan class=\"lineNumber\"\u003e5\u003c/span\u003e\u003cspan class=\"hljs-comment\"\u003e# gci就是命令的alias\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e6\u003c/span\u003e \n\u003cspan class=\"lineNumber\"\u003e7\u003c/span\u003e\u003cspan class=\"hljs-built_in\"\u003eGet-ChildItem\u003c/span\u003e | \u003cspan class=\"hljs-built_in\"\u003eForEach-Object\u003c/span\u003e {\n\u003cspan class=\"lineNumber\"\u003e8\u003c/span\u003e \u003cspan class=\"hljs-built_in\"\u003eCopy-Item\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003e-Path\u003c/span\u003e \u003cspan class=\"hljs-variable\"\u003e$_\u003c/span\u003e.FullName \u003cspan class=\"hljs-literal\"\u003e-destination\u003c/span\u003e C:\\NewDirectory\\\n\u003cspan class=\"lineNumber\"\u003e9\u003c/span\u003e}\n\u003cspan class=\"lineNumber\"\u003e10\u003c/span\u003e\u003cspan class=\"hljs-comment\"\u003e#This may be shortened to:\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e11\u003c/span\u003e\u003cspan class=\"hljs-built_in\"\u003egci\u003c/span\u003e | % { \u003cspan class=\"hljs-built_in\"\u003eCopy\u003c/span\u003e \u003cspan class=\"hljs-variable\"\u003e$_\u003c/span\u003e.FullName C:\\NewDirectory\\ }\u003c/code\u003e\u003c/pre\u003e \n\n\u003ch3\u003e1.4 使用\u003ccode\u003e.net\u003c/code\u003e库的方法\u003c/h3\u003e\n\u003cp\u003epowershell天生支持\u003ccode\u003e.net\u003c/code\u003e的各种方法.毕竟是微软一家子的成员.例如:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-powershell\"\u003e\u003cspan class=\"lineNumber\"\u003e1\u003c/span\u003e\u003cspan class=\"hljs-comment\"\u003e#calling Path.GetFileName()\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e2\u003c/span\u003eC:\\\u003e [\u003cspan class=\"hljs-type\"\u003eSystem.IO.Path\u003c/span\u003e]::GetFileName(\u003cspan class=\"hljs-string\"\u003e'C:\\Windows\\explorer.exe'\u003c/span\u003e)\n\u003cspan class=\"lineNumber\"\u003e3\u003c/span\u003eexplorer.exe\u003c/code\u003e\u003c/pre\u003e \n\n\u003cp\u003e如果你熟悉\u003ccode\u003e.net\u003c/code\u003e 的话,使用它的库函数就能如虎添翼事半功倍.\u003c/p\u003e\n\u003cp\u003e使用静态方法可以很直接,但是如果有些方法不是静态方法,则需要对\u003ccode\u003eclass\u003c/code\u003e进行实例化.举例:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-powershell\"\u003e\u003cspan class=\"lineNumber\"\u003e1\u003c/span\u003e➜  Markdown笔记 \u003cspan class=\"hljs-variable\"\u003e$object\u003c/span\u003e = [\u003cspan class=\"hljs-type\"\u003eSystem.DateTime\u003c/span\u003e]::now\n\u003cspan class=\"lineNumber\"\u003e2\u003c/span\u003e➜  Markdown笔记 \u003cspan class=\"hljs-variable\"\u003e$object\u003c/span\u003e.AddHours(\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e)\n\u003cspan class=\"lineNumber\"\u003e3\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e2020\u003c/span\u003e年\u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e月\u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e日 \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e00\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e07\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e \n\n\u003cp\u003e直接就输出一个修改过的时间结果.\u003c/p\u003e\n\u003ch3\u003e1.5 安装或者设置\u003c/h3\u003e\n\u003cp\u003e现在默认windows7以上自带\u003ccode\u003epowershell\u003c/code\u003e,但是在其他平台,则需要手动安装,例如支持在Ubuntu上安装\u003ccode\u003epowershell v6\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003epowershell脚本的注释使用\u003ccode\u003e#\u003c/code\u003e.或者长注释使用\u003ccode\u003e\u0026#x3C;# comment #\u003e\u003c/code\u003e内部添加注释,支持换行.\u003c/p\u003e\n\u003ch3\u003e1.6 简述创建对象\u003c/h3\u003e\n\u003cp\u003epowershell以管道传递对象,对象在powershell中具有独特的地位.举个例子.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-powershell\"\u003e\u003cspan class=\"lineNumber\"\u003e1\u003c/span\u003e\u003cspan class=\"hljs-comment\"\u003e# 创建一个时间对象\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e2\u003c/span\u003e\u003cspan class=\"hljs-variable\"\u003e$var\u003c/span\u003e = \u003cspan class=\"hljs-built_in\"\u003enew-object\u003c/span\u003e system\u003cspan class=\"hljs-literal\"\u003e-datetime\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e3\u003c/span\u003e\u003cspan class=\"hljs-comment\"\u003e# 创建一个流对象\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e4\u003c/span\u003e\u003cspan class=\"hljs-variable\"\u003e$sr\u003c/span\u003e = \u003cspan class=\"hljs-built_in\"\u003enew-object\u003c/span\u003e system.io.streamreader \u003cspan class=\"hljs-literal\"\u003e-argumentList\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"file stream\"\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e5\u003c/span\u003e \n\u003cspan class=\"lineNumber\"\u003e6\u003c/span\u003e\u003cspan class=\"hljs-comment\"\u003e# 创建一个复杂对象\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e7\u003c/span\u003e\u003cspan class=\"hljs-variable\"\u003e$newObj\u003c/span\u003e = [\u003cspan class=\"hljs-type\"\u003ePScustomObject\u003c/span\u003e]\u003cspan class=\"hljs-selector-tag\"\u003e@\u003c/span\u003e{\n\u003cspan class=\"lineNumber\"\u003e8\u003c/span\u003e\tComputerName = \u003cspan class=\"hljs-string\"\u003e'server1'\u003c/span\u003e,\n\u003cspan class=\"lineNumber\"\u003e9\u003c/span\u003e\tEnv = \u003cspan class=\"hljs-string\"\u003e'Production'\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e10\u003c/span\u003e}\n\u003cspan class=\"lineNumber\"\u003e11\u003c/span\u003e \n\u003cspan class=\"lineNumber\"\u003e12\u003c/span\u003e\u003cspan class=\"hljs-comment\"\u003e# 创建一个ie浏览器对象\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e13\u003c/span\u003e\u003cspan class=\"hljs-variable\"\u003e$IE1\u003c/span\u003e = \u003cspan class=\"hljs-built_in\"\u003eNew-Object\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003e-COMObject\u003c/span\u003e InternetExplorer.Application \u003cspan class=\"hljs-literal\"\u003e-Property\u003c/span\u003e \u003cspan class=\"hljs-selector-tag\"\u003e@\u003c/span\u003e{Navigate2=\u003cspan class=\"hljs-string\"\u003e\"www.microsoft.com\"\u003c/span\u003e; Visible = \u003cspan class=\"hljs-variable\"\u003e$True\u003c/span\u003e}\n\u003cspan class=\"lineNumber\"\u003e14\u003c/span\u003e \n\u003cspan class=\"lineNumber\"\u003e15\u003c/span\u003e\u003cspan class=\"hljs-comment\"\u003e# The following command gets the same results as the example above.\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e16\u003c/span\u003e\u003cspan class=\"hljs-variable\"\u003e$IE2\u003c/span\u003e = \u003cspan class=\"hljs-built_in\"\u003eNew-Object\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003e-COMObject\u003c/span\u003e InternetExplorer.Application`\n\u003cspan class=\"lineNumber\"\u003e17\u003c/span\u003e\u003cspan class=\"hljs-variable\"\u003e$IE2\u003c/span\u003e.Navigate2(\u003cspan class=\"hljs-string\"\u003e\"www.microsoft.com\"\u003c/span\u003e)`\n\u003cspan class=\"lineNumber\"\u003e18\u003c/span\u003e\u003cspan class=\"hljs-variable\"\u003e$IE2\u003c/span\u003e.Visible = \u003cspan class=\"hljs-variable\"\u003e$True\u003c/span\u003e`\u003c/code\u003e\u003c/pre\u003e \n\n\u003cp\u003e上述可以看出创建对象的时候可以设置一些属性,或者创建基础实例之后再设置属性.所有的对象都可以通过管道进行传输.对象的集合在导入和导出特定的格式,例如csv或者xml的时候非常有效,例如命令\u003ccode\u003eexport-csv\u003c/code\u003e的每一行都是一个对象.\u003c/p\u003e\n\u003ch2\u003echapter2: variable in powershell\u003c/h2\u003e\n\u003cblockquote\u003e\n\u003cp\u003e变量用于保存数据,以便于后续使用.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003ch3\u003e2.1 简单变量和数组\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-powershell\"\u003e\u003cspan class=\"lineNumber\"\u003e1\u003c/span\u003e\u003cspan class=\"hljs-variable\"\u003e$name\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e\"root\"\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e2\u003c/span\u003e\u003cspan class=\"hljs-variable\"\u003e$numArray\u003c/span\u003e = \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e,\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e3\u003c/span\u003e\u003cspan class=\"hljs-variable\"\u003e$newArray\u003c/span\u003e = \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e\"2\"\u003c/span\u003e \u003cspan class=\"hljs-comment\"\u003e# 不限类型,比较灵活\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e4\u003c/span\u003e\u003cspan class=\"hljs-variable\"\u003e$numArray\u003c/span\u003e = \u003cspan class=\"hljs-variable\"\u003e$numArray\u003c/span\u003e +\u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e5\u003c/span\u003e\u003cspan class=\"hljs-variable\"\u003e$newArray\u003c/span\u003e = \u003cspan class=\"hljs-variable\"\u003e$newAarray\u003c/span\u003e + \u003cspan class=\"hljs-variable\"\u003e$numArray\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e \n\n\u003ch3\u003e2.2 拆分变量为数组\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-powershell\"\u003e\u003cspan class=\"lineNumber\"\u003e1\u003c/span\u003e\u003cspan class=\"hljs-variable\"\u003e$input\u003c/span\u003e=\u003cspan class=\"hljs-string\"\u003e\"foo.bar.baz\"\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e2\u003c/span\u003e\u003cspan class=\"hljs-variable\"\u003e$parts\u003c/span\u003e=\u003cspan class=\"hljs-variable\"\u003e$input\u003c/span\u003e.Split(\u003cspan class=\"hljs-string\"\u003e\".\"\u003c/span\u003e)\n\u003cspan class=\"lineNumber\"\u003e3\u003c/span\u003e\u003cspan class=\"hljs-variable\"\u003e$foo\u003c/span\u003e=\u003cspan class=\"hljs-variable\"\u003e$parts\u003c/span\u003e[\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e]\n\u003cspan class=\"lineNumber\"\u003e4\u003c/span\u003e\u003cspan class=\"hljs-variable\"\u003e$bar\u003c/span\u003e=\u003cspan class=\"hljs-variable\"\u003e$parts\u003c/span\u003e[\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e]\n\u003cspan class=\"lineNumber\"\u003e5\u003c/span\u003e\u003cspan class=\"hljs-variable\"\u003e$baz\u003c/span\u003e=\u003cspan class=\"hljs-variable\"\u003e$parts\u003c/span\u003e[\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e]\n\u003cspan class=\"lineNumber\"\u003e6\u003c/span\u003e\u003cspan class=\"hljs-comment\"\u003e#You can simply do this:\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e7\u003c/span\u003e\u003cspan class=\"hljs-variable\"\u003e$foo\u003c/span\u003e,\u003cspan class=\"hljs-variable\"\u003e$bar\u003c/span\u003e,\u003cspan class=\"hljs-variable\"\u003e$baz\u003c/span\u003e=\u003cspan class=\"hljs-variable\"\u003e$input\u003c/span\u003e.Split(\u003cspan class=\"hljs-string\"\u003e\".\"\u003c/span\u003e)\u003c/code\u003e\u003c/pre\u003e \n\n\u003cp\u003e灵活处理字符串和数组.类似\u003ccode\u003ejs\u003c/code\u003e,也可以根据变量的数量去分配.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-powershell\"\u003e\u003cspan class=\"lineNumber\"\u003e1\u003c/span\u003e\u003cspan class=\"hljs-variable\"\u003e$foo\u003c/span\u003e, \u003cspan class=\"hljs-variable\"\u003e$_\u003c/span\u003e = \u003cspan class=\"hljs-variable\"\u003e$input\u003c/span\u003e.Split(\u003cspan class=\"hljs-string\"\u003e\".\"\u003c/span\u003e)\n\u003cspan class=\"lineNumber\"\u003e2\u003c/span\u003e\u003cspan class=\"hljs-comment\"\u003e# foo则保存首个拆分的值,_保存剩下的数组.\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e \n\n\u003ch3\u003e2.3 Scope\u003c/h3\u003e\n\u003cp\u003e作用域范围跟分为局部和全局,函数内部只在内部有效,支持闭包.如果你想要指定外部的变量,以便于和函数内部同名变量区分.则可以使用如下方式:\u003c/p\u003e\n\u003cp\u003e\u003ccode\u003e$local:foo\u003c/code\u003e 和 \u003ccode\u003e$global:foo\u003c/code\u003e,如果存在多层嵌套,则\u003ccode\u003eglobal\u003c/code\u003e为最外层.\u003c/p\u003e\n\u003ch3\u003e2.4 移除变量\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-powershell\"\u003e\u003cspan class=\"lineNumber\"\u003e1\u003c/span\u003e\u003cspan class=\"hljs-comment\"\u003e# 需要指定类型为 Variable,再指定变量名\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e2\u003c/span\u003e\u003cspan class=\"hljs-built_in\"\u003eRemove-Item\u003c/span\u003e Variable:\\foo\u003c/code\u003e\u003c/pre\u003e \n\n\u003cp\u003e变量支持像处理文件系统项目的大多数的\u003ccode\u003e*-item\u003c/code\u003e命令进行处理.\u003c/p\u003e\n\u003cp\u003e更显式的删除变量,可以使用\u003ccode\u003eremove-variable\u003c/code\u003e命令.其简写是\u003ccode\u003erv\u003c/code\u003e.命令如\u003ccode\u003erv foo\u003c/code\u003e\u003c/p\u003e\n\u003ch2\u003echapter 3: Operators\u003c/h2\u003e\n\u003ch3\u003e3.1 比较运算符\u003c/h3\u003e\n\u003cp\u003e类似\u003ccode\u003ebash\u003c/code\u003e,使用如下方式进行比较,返回\u003ccode\u003etrue\u003c/code\u003e或者\u003ccode\u003efalse\u003c/code\u003e的\u003ccode\u003eboolean\u003c/code\u003e值.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-powershell\"\u003e\u003cspan class=\"lineNumber\"\u003e1\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e \u003cspan class=\"hljs-operator\"\u003e-eq\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e2\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e \u003cspan class=\"hljs-operator\"\u003e-ne\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e3\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e \u003cspan class=\"hljs-operator\"\u003e-lt\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e4\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e \u003cspan class=\"hljs-operator\"\u003e-gt\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e5\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e \u003cspan class=\"hljs-operator\"\u003e-ge\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e6\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e \u003cspan class=\"hljs-operator\"\u003e-le\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e7\u003c/span\u003e\u003cspan class=\"hljs-comment\"\u003e# 针对大小写是否敏感\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e8\u003c/span\u003ea \u003cspan class=\"hljs-literal\"\u003e-eqi\u003c/span\u003e A \u003cspan class=\"hljs-comment\"\u003e# true,字符串不敏感,eqc则敏感\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e9\u003c/span\u003e \n\u003cspan class=\"lineNumber\"\u003e10\u003c/span\u003e\u003cspan class=\"hljs-comment\"\u003e# 字符串比较\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e11\u003c/span\u003e\u003cspan class=\"hljs-comment\"\u003e# root at LAPTOP-G92L1V81 in D:\\pw7 workstation\\git-repos\\nextjs_blog\\posts on git:master ≣ +0 ~1 -0 ! [1:39:32]\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e12\u003c/span\u003e➜ \u003cspan class=\"hljs-string\"\u003e\"string\"\u003c/span\u003e \u003cspan class=\"hljs-operator\"\u003e-like\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"*ing\"\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e13\u003c/span\u003eTrue\n\u003cspan class=\"lineNumber\"\u003e14\u003c/span\u003e\u003cspan class=\"hljs-comment\"\u003e# root at LAPTOP-G92L1V81 in D:\\pw7 workstation\\git-repos\\nextjs_blog\\posts on git:master ≣ +0 ~1 -0 ! [1:40:00]\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e15\u003c/span\u003e➜ \u003cspan class=\"hljs-string\"\u003e\"string\"\u003c/span\u003e \u003cspan class=\"hljs-operator\"\u003e-like\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"ing\"\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e16\u003c/span\u003eFalse\n\u003cspan class=\"lineNumber\"\u003e17\u003c/span\u003e \n\u003cspan class=\"lineNumber\"\u003e18\u003c/span\u003e\u003cspan class=\"hljs-comment\"\u003e# 加not取反\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e19\u003c/span\u003e➜ \u003cspan class=\"hljs-string\"\u003e\"string\"\u003c/span\u003e \u003cspan class=\"hljs-operator\"\u003e-notlike\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"ing\"\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e20\u003c/span\u003eTrue\n\u003cspan class=\"lineNumber\"\u003e21\u003c/span\u003e \n\u003cspan class=\"lineNumber\"\u003e22\u003c/span\u003e\u003cspan class=\"hljs-comment\"\u003e# 支持正则表达式\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e23\u003c/span\u003e➜ \u003cspan class=\"hljs-string\"\u003e\"string\"\u003c/span\u003e \u003cspan class=\"hljs-operator\"\u003e-match\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"ing\"\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e24\u003c/span\u003eTrue\n\u003cspan class=\"lineNumber\"\u003e25\u003c/span\u003e\u003cspan class=\"hljs-comment\"\u003e# root at LAPTOP-G92L1V81 in D:\\pw7 workstation\\git-repos\\nextjs_blog\\posts on git:master ≣ +0 ~1 -0 ! [1:41:15]\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e26\u003c/span\u003e➜ \u003cspan class=\"hljs-string\"\u003e\"string\"\u003c/span\u003e \u003cspan class=\"hljs-operator\"\u003e-match\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"inge\"\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e27\u003c/span\u003eFalse\n\u003cspan class=\"lineNumber\"\u003e28\u003c/span\u003e\u003cspan class=\"hljs-comment\"\u003e# root at LAPTOP-G92L1V81 in D:\\pw7 workstation\\git-repos\\nextjs_blog\\posts on git:master ≣ +0 ~1 -0 ! [1:41:22]\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e29\u003c/span\u003e➜ \u003cspan class=\"hljs-string\"\u003e\"string\"\u003c/span\u003e \u003cspan class=\"hljs-operator\"\u003e-match\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"ing\u0026#x26;\"\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e30\u003c/span\u003eFalse\n\u003cspan class=\"lineNumber\"\u003e31\u003c/span\u003e\u003cspan class=\"hljs-comment\"\u003e# root at LAPTOP-G92L1V81 in D:\\pw7 workstation\\git-repos\\nextjs_blog\\posts on git:master ≣ +0 ~1 -0 ! [1:41:33]\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e32\u003c/span\u003e➜ \u003cspan class=\"hljs-string\"\u003e\"string\"\u003c/span\u003e \u003cspan class=\"hljs-operator\"\u003e-match\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"ing\u003cspan class=\"hljs-variable\"\u003e$\u003c/span\u003e\"\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e33\u003c/span\u003eTrue\n\u003cspan class=\"lineNumber\"\u003e34\u003c/span\u003e \n\u003cspan class=\"lineNumber\"\u003e35\u003c/span\u003e\u003cspan class=\"hljs-comment\"\u003e# 集合数据比较\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e36\u003c/span\u003e \n\u003cspan class=\"lineNumber\"\u003e37\u003c/span\u003e\u003cspan class=\"hljs-comment\"\u003e# root at LAPTOP-G92L1V81 in D:\\pw7 workstation\\git-repos\\nextjs_blog\\posts on git:master ≣ +0 ~1 -0 ! [1:41:37]\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e38\u003c/span\u003e➜ \u003cspan class=\"hljs-string\"\u003e\"12\"\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e\"abc\"\u003c/span\u003e \u003cspan class=\"hljs-operator\"\u003e-contains\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"1\"\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e39\u003c/span\u003eFalse\n\u003cspan class=\"lineNumber\"\u003e40\u003c/span\u003e\u003cspan class=\"hljs-comment\"\u003e# root at LAPTOP-G92L1V81 in D:\\pw7 workstation\\git-repos\\nextjs_blog\\posts on git:master ≣ +0 ~1 -0 ! [1:44:14]\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e41\u003c/span\u003e➜ \u003cspan class=\"hljs-string\"\u003e\"12\"\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e\"abc\"\u003c/span\u003e \u003cspan class=\"hljs-operator\"\u003e-contains\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"12\"\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e42\u003c/span\u003eTrue\n\u003cspan class=\"lineNumber\"\u003e43\u003c/span\u003e \n\u003cspan class=\"lineNumber\"\u003e44\u003c/span\u003e➜ \u003cspan class=\"hljs-string\"\u003e\"12\"\u003c/span\u003e \u003cspan class=\"hljs-operator\"\u003e-in\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"aaa\"\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e\"12\"\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e45\u003c/span\u003eTrue\u003c/code\u003e\u003c/pre\u003e \n\n\u003ch3\u003e3.2 算数运算\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-powershell\"\u003e\u003cspan class=\"lineNumber\"\u003e1\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e+\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e\t\u003cspan class=\"hljs-comment\"\u003e# Addition\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e2\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\u003cspan class=\"hljs-literal\"\u003e-2\u003c/span\u003e\t\u003cspan class=\"hljs-comment\"\u003e# Subtraction\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e3\u003c/span\u003e\u003cspan class=\"hljs-literal\"\u003e-1\u003c/span\u003e\t\u003cspan class=\"hljs-comment\"\u003e# Set negative value\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e4\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e*\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e\t\u003cspan class=\"hljs-comment\"\u003e# Multiplication\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e5\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e\t\u003cspan class=\"hljs-comment\"\u003e# Division\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e6\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e%\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e\t\u003cspan class=\"hljs-comment\"\u003e# Modulus\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e7\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e100\u003c/span\u003e \u003cspan class=\"hljs-operator\"\u003e-shl\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e \u003cspan class=\"hljs-comment\"\u003e# 按位左移\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e8\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e100\u003c/span\u003e \u003cspan class=\"hljs-operator\"\u003e-shr\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e \u003cspan class=\"hljs-comment\"\u003e# 按位右移\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e9\u003c/span\u003e \n\u003cspan class=\"lineNumber\"\u003e10\u003c/span\u003e\u003cspan class=\"hljs-comment\"\u003e# 变量计算\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e11\u003c/span\u003e\u003cspan class=\"hljs-variable\"\u003e$var\u003c/span\u003e = \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e12\u003c/span\u003e\u003cspan class=\"hljs-variable\"\u003e$var\u003c/span\u003e += \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e13\u003c/span\u003e\u003cspan class=\"hljs-variable\"\u003e$var\u003c/span\u003e++\n\u003cspan class=\"lineNumber\"\u003e14\u003c/span\u003e\u003cspan class=\"hljs-variable\"\u003e$var\u003c/span\u003e += \u003cspan class=\"hljs-string\"\u003e\"2\"\u003c/span\u003e \u003cspan class=\"hljs-comment\"\u003e# 也支持,自动类型转换\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e \n\n\u003ch3\u003e3.3 输出重定向操作\u003c/h3\u003e\n\u003cblockquote\u003e\n\u003cp\u003e大神详解:\u003ca href=\"https://devblogs.microsoft.com/scripting/understanding-streams-redirection-and-write-host-in-powershell/\"\u003eUnderstanding Streams, Redirection, and Write-Host in PowerShell | Scripting Blog\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e执行命令或者程序,将产生不同类型的输出信息流.\u003c/p\u003e\n\u003cp\u003e\u003cimg src=\"https://devblogs.microsoft.com/wp-content/uploads/sites/29/2019/02/2570.1.png\" alt=\"\"\u003e\u003c/p\u003e\n\u003cp\u003e顺利执行将产生success的输出流,举个例子:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-powershell\"\u003e\u003cspan class=\"lineNumber\"\u003e1\u003c/span\u003ecmdlet \u003e file \u003cspan class=\"hljs-comment\"\u003e# 发送success输出流重写file的内容\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e2\u003c/span\u003ecmdlet \u003e\u003e file \u003cspan class=\"hljs-comment\"\u003e# 追加success输出流到file的文件末尾\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e3\u003c/span\u003ecmdlet \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e\u003e\u0026#x26;\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e \u003cspan class=\"hljs-comment\"\u003e# 1代表success状态的输出流,此时指的是将success(1)和error(2)的输出重定向到error流中去\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e4\u003c/span\u003e \n\u003cspan class=\"lineNumber\"\u003e5\u003c/span\u003ecmdlet \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e\u003e file \u003cspan class=\"hljs-comment\"\u003e# error(2) 输出流\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e6\u003c/span\u003ecmdlet \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e\u003e file \u003cspan class=\"hljs-comment\"\u003e# powershell v3+支持的warning数据流\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e7\u003c/span\u003ecmdlet \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e\u003e file \u003cspan class=\"hljs-comment\"\u003e# powershell v3+支持的verbose输出流,详细消息流通常用于提供命令处理的相关信息,便于调试\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e8\u003c/span\u003ecmdlet \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e\u003e file \u003cspan class=\"hljs-comment\"\u003e# Debug\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e9\u003c/span\u003ecmdlet \u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e\u003e file \u003cspan class=\"hljs-comment\"\u003e# information level\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e \n\n\u003cp\u003e不同的流是平行的,在管道之间传递对象,我们并不希望接受cmdlet各种类型的流式数据.且管道符默认接收了\u003ccode\u003esuccess\u003c/code\u003e级别的信息.其他的流的数据发往了其他的接收处.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eWindows PowerShell inventor, Jeffrey Snover, says that \u003ca href=\"http://www.jsnover.com/blog/2013/12/07/write-host-considered-harmful/\"\u003eWrite-Host is harmful\u003c/a\u003e\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cp\u003e\u003cstrong\u003eWrite-Host is not written to any stream\u003c/strong\u003e.\u003ccode\u003ewrite-host\u003c/code\u003e不会污染输出流,且\u003ccode\u003e不向任何流进行输入\u003c/code\u003e.单纯向屏幕输出.\u003c/p\u003e\n\u003cp\u003e也就是说你无法将\u003ccode\u003ewrite-host\u003c/code\u003e的message定向到其他流,也没法分配给变量.\u003c/p\u003e\n\u003cp\u003e还可以看看这里:\u003ca href=\"https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_redirection?view=powershell-7\"\u003eabout_Redirection - PowerShell | Microsoft Docs\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003e另外举个例子:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-powershell\"\u003e\u003cspan class=\"lineNumber\"\u003e1\u003c/span\u003e\u003cspan class=\"hljs-comment\"\u003e# 同时ls查看两个目录,如下命令可以将错误信息重定向转移走,输入到z文件,而不会只是将success的ls d:结果输出z\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e2\u003c/span\u003e▶ \u003cspan class=\"hljs-built_in\"\u003els\u003c/span\u003e D:,fake *\u003e z\n\u003cspan class=\"lineNumber\"\u003e3\u003c/span\u003e \n\u003cspan class=\"lineNumber\"\u003e4\u003c/span\u003e\u003cspan class=\"hljs-comment\"\u003e# 如果不重定向\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e5\u003c/span\u003e▶ \u003cspan class=\"hljs-built_in\"\u003els\u003c/span\u003e D:,fake \u003e z\n\u003cspan class=\"lineNumber\"\u003e6\u003c/span\u003e\u003cspan class=\"hljs-built_in\"\u003eGet-ChildItem\u003c/span\u003e: Cannot find path \u003cspan class=\"hljs-string\"\u003e'C:\\Users\\root\\fake'\u003c/span\u003e because it does not exist.\n\u003cspan class=\"lineNumber\"\u003e7\u003c/span\u003e~ ⨯\n\u003cspan class=\"lineNumber\"\u003e8\u003c/span\u003e▶ \u003cspan class=\"hljs-built_in\"\u003ecat\u003c/span\u003e z\n\u003cspan class=\"lineNumber\"\u003e9\u003c/span\u003e \n\u003cspan class=\"lineNumber\"\u003e10\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e11\u003c/span\u003e    Directory: D:\\pw7 workstation\\git\u003cspan class=\"hljs-literal\"\u003e-repos\u003c/span\u003e\\nextjs_blog\\posts\n\u003cspan class=\"lineNumber\"\u003e12\u003c/span\u003e\u003cspan class=\"hljs-comment\"\u003e# 则z保存了success的信息\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e \n\n\u003cp\u003e至于,将\u003ccode\u003esuccess\u003c/code\u003e消息重定向到\u003ccode\u003eerror流\u003c/code\u003e的操作,终端提示错误,跟书本不符.不过不会真有人想要做这种事吧.\u003c/p\u003e\n\u003cp\u003e另外,我用过几次将没必要的错误信息流重定向到\u003ccode\u003e$null\u003c/code\u003e中去.或者将没必要的所有流都扔掉:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-powershell\"\u003e\u003cspan class=\"lineNumber\"\u003e1\u003c/span\u003ecmdlet *\u003e\u003cspan class=\"hljs-variable\"\u003e$null\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e \n\n\u003ch3\u003e3.4 混合操作类型\u003c/h3\u003e\n\u003cp\u003e举例如下:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-powershell\"\u003e\u003cspan class=\"lineNumber\"\u003e1\u003c/span\u003e▶ \u003cspan class=\"hljs-string\"\u003e\"2\"\u003c/span\u003e+\u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e2\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e3\u003c/span\u003e~\n\u003cspan class=\"lineNumber\"\u003e4\u003c/span\u003e▶ \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e+\u003cspan class=\"hljs-string\"\u003e\"22\"\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e5\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e24\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e6\u003c/span\u003e~\n\u003cspan class=\"lineNumber\"\u003e7\u003c/span\u003e➜ \u003cspan class=\"hljs-string\"\u003e\"2\"\u003c/span\u003e * \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e8\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e22\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e9\u003c/span\u003e➜ \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e * \u003cspan class=\"hljs-string\"\u003e\"2\"\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e10\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e11\u003c/span\u003e➜ \u003cspan class=\"hljs-variable\"\u003e$a\u003c/span\u003e = \u003cspan class=\"hljs-built_in\"\u003eRead-Host\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e12\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e33\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e13\u003c/span\u003e➜ \u003cspan class=\"hljs-variable\"\u003e$a\u003c/span\u003e \u003cspan class=\"hljs-operator\"\u003e-gt\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e14\u003c/span\u003eFalse\n\u003cspan class=\"lineNumber\"\u003e15\u003c/span\u003e➜ \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e \u003cspan class=\"hljs-operator\"\u003e-gt\u003c/span\u003e \u003cspan class=\"hljs-variable\"\u003e$a\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e16\u003c/span\u003eFalse\u003c/code\u003e\u003c/pre\u003e \n\n\u003cp\u003e左边的数据类型决定了整体的计算和数据转换方式.\u003c/p\u003e\n\u003ch3\u003e3.5 逻辑操作和字符串变换操作\u003c/h3\u003e\n\u003cp\u003e举例:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-powershell\"\u003e\u003cspan class=\"lineNumber\"\u003e1\u003c/span\u003e\u003cspan class=\"hljs-operator\"\u003e-and\u003c/span\u003e \u003cspan class=\"hljs-comment\"\u003e# 与\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e2\u003c/span\u003e\u003cspan class=\"hljs-operator\"\u003e-or\u003c/span\u003e \u003cspan class=\"hljs-comment\"\u003e# 或\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e3\u003c/span\u003e\u003cspan class=\"hljs-operator\"\u003e-xor\u003c/span\u003e \u003cspan class=\"hljs-comment\"\u003e# 异或\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e4\u003c/span\u003e\u003cspan class=\"hljs-operator\"\u003e-not\u003c/span\u003e \u003cspan class=\"hljs-comment\"\u003e# not\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e5\u003c/span\u003e! \u003cspan class=\"hljs-comment\"\u003e# not\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e6\u003c/span\u003e \n\u003cspan class=\"lineNumber\"\u003e7\u003c/span\u003e\u003cspan class=\"hljs-comment\"\u003e# 常见替换\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e8\u003c/span\u003e➜ \u003cspan class=\"hljs-string\"\u003e\"just a demo\"\u003c/span\u003e \u003cspan class=\"hljs-operator\"\u003e-replace\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"demo\"\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e\"test\"\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e9\u003c/span\u003ejust a test\n\u003cspan class=\"lineNumber\"\u003e10\u003c/span\u003e \n\u003cspan class=\"lineNumber\"\u003e11\u003c/span\u003e\u003cspan class=\"hljs-comment\"\u003e# 正则表达式单引号替换\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e12\u003c/span\u003e➜ \u003cspan class=\"hljs-string\"\u003e\"root@gmail.com\"\u003c/span\u003e \u003cspan class=\"hljs-operator\"\u003e-replace\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e'^[\\w]+@(.+)'\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e'$1'\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e13\u003c/span\u003egmail.com\n\u003cspan class=\"lineNumber\"\u003e14\u003c/span\u003e \n\u003cspan class=\"lineNumber\"\u003e15\u003c/span\u003e\u003cspan class=\"hljs-comment\"\u003e# 拆分数组\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e16\u003c/span\u003e➜ \u003cspan class=\"hljs-string\"\u003e\"root@gmail.com\"\u003c/span\u003e \u003cspan class=\"hljs-operator\"\u003e-split\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"@\"\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e17\u003c/span\u003eroot\n\u003cspan class=\"lineNumber\"\u003e18\u003c/span\u003egmail.com\n\u003cspan class=\"lineNumber\"\u003e19\u003c/span\u003e \n\u003cspan class=\"lineNumber\"\u003e20\u003c/span\u003e\u003cspan class=\"hljs-comment\"\u003e# join数组\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e21\u003c/span\u003e➜ \u003cspan class=\"hljs-string\"\u003e\"1\"\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e\"1\"\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e\"0\"\u003c/span\u003e \u003cspan class=\"hljs-operator\"\u003e-join\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\":\"\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e22\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e \n\n\u003ch2\u003eChapter 4: Special Operators\u003c/h2\u003e\n\u003ch3\u003e4.1 数组表达运算符\u003c/h3\u003e\n\u003cp\u003e通过一个表达式返回一个数组:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-powershell\"\u003e\u003cspan class=\"lineNumber\"\u003e1\u003c/span\u003e➜  posts git:(master) \u003cspan class=\"hljs-selector-tag\"\u003e@\u003c/span\u003e(\u003cspan class=\"hljs-built_in\"\u003eGet-ChildItem\u003c/span\u003e C:\\Windows\\System32\\ntdll.dll)\n\u003cspan class=\"lineNumber\"\u003e2\u003c/span\u003e \n\u003cspan class=\"lineNumber\"\u003e3\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e4\u003c/span\u003e    Directory: C:\\Windows\\System32\n\u003cspan class=\"lineNumber\"\u003e5\u003c/span\u003e \n\u003cspan class=\"lineNumber\"\u003e6\u003c/span\u003eMode                 LastWriteTime         Length Name\n\u003cspan class=\"lineNumber\"\u003e7\u003c/span\u003e----                 -------------         ------ ----\n\u003cspan class=\"lineNumber\"\u003e8\u003c/span\u003e\u003cspan class=\"hljs-literal\"\u003e-a\u003c/span\u003e---           \u003cspan class=\"hljs-number\"\u003e2020\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e17\u003c/span\u003e    \u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e        \u003cspan class=\"hljs-number\"\u003e1999968\u003c/span\u003e ntdll.dll\n\u003cspan class=\"lineNumber\"\u003e9\u003c/span\u003e \n\u003cspan class=\"lineNumber\"\u003e10\u003c/span\u003e➜  posts git:(master) \u003cspan class=\"hljs-selector-tag\"\u003e@\u003c/span\u003e(\u003cspan class=\"hljs-built_in\"\u003eGet-ChildItem\u003c/span\u003e C:\\Windows\\System32\\ntdll.dll)[\u003cspan class=\"hljs-number\"\u003e0\u003c/span\u003e]\n\u003cspan class=\"lineNumber\"\u003e11\u003c/span\u003e \n\u003cspan class=\"lineNumber\"\u003e12\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e13\u003c/span\u003e    Directory: C:\\Windows\\System32\n\u003cspan class=\"lineNumber\"\u003e14\u003c/span\u003e \n\u003cspan class=\"lineNumber\"\u003e15\u003c/span\u003eMode                 LastWriteTime         Length Name\n\u003cspan class=\"lineNumber\"\u003e16\u003c/span\u003e----                 -------------         ------ ----\n\u003cspan class=\"lineNumber\"\u003e17\u003c/span\u003e\u003cspan class=\"hljs-literal\"\u003e-a\u003c/span\u003e---           \u003cspan class=\"hljs-number\"\u003e2020\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e/\u003cspan class=\"hljs-number\"\u003e17\u003c/span\u003e    \u003cspan class=\"hljs-number\"\u003e20\u003c/span\u003e:\u003cspan class=\"hljs-number\"\u003e10\u003c/span\u003e        \u003cspan class=\"hljs-number\"\u003e1999968\u003c/span\u003e ntdll.dll\n\u003cspan class=\"lineNumber\"\u003e18\u003c/span\u003e \n\u003cspan class=\"lineNumber\"\u003e19\u003c/span\u003e➜  posts git:(master) \u003cspan class=\"hljs-selector-tag\"\u003e@\u003c/span\u003e(\u003cspan class=\"hljs-built_in\"\u003eGet-ChildItem\u003c/span\u003e C:\\Windows\\System32\\ntdll.dll)[\u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e]\n\u003cspan class=\"lineNumber\"\u003e20\u003c/span\u003e➜  posts git:(master)\u003c/code\u003e\u003c/pre\u003e \n\n\u003cp\u003e如上所述,\u003ccode\u003e@()\u003c/code\u003e内部的表达式处理返回值将得到一个数组.\u003c/p\u003e\n\u003ch3\u003e4.2 调用运算符\u003c/h3\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-powershell\"\u003e\u003cspan class=\"lineNumber\"\u003e1\u003c/span\u003e\u003cspan class=\"hljs-variable\"\u003e$command\u003c/span\u003e = \u003cspan class=\"hljs-string\"\u003e'ls'\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e2\u003c/span\u003e\u0026#x26;\u003cspan class=\"hljs-variable\"\u003e$command\u003c/span\u003e \u003cspan class=\"hljs-comment\"\u003e# 等于直接调用字符串的内容,视为命令并执行\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e \n\n\u003ch3\u003e4.3 点源操作(dot sourcing operator)\u003c/h3\u003e\n\u003cp\u003e\u003ccode\u003e. $profile\u003c/code\u003e是我很常用的一个命令,因为我经常修改预加载的配置文件\u003ccode\u003e$profile\u003c/code\u003e.这个变量指向一个\u003ccode\u003e.ps1\u003c/code\u003e文件,每个console打开的时候都会\u003ccode\u003erun\u003c/code\u003e这个文件.因此,可以在这里面设置一下alias或者function.\u003c/p\u003e\n\u003cp\u003e当我们在当前terminal下使用\u003ccode\u003e. xxx.ps1\u003c/code\u003e命令执行此脚本的时候,即将此脚本的执行环境范围设置为当前\u003ccode\u003eterminal session\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003e回到\u003ccode\u003e$profile\u003c/code\u003e的例子,我修改了这个脚本,并且在当前\u003ccode\u003eterminal\u003c/code\u003e执行了\u003ccode\u003e. $profile\u003c/code\u003e,则此脚本内的函数即加载到我的\u003ccode\u003eterminal session\u003c/code\u003e内了.我可以轻松调用此脚本内的函数处理我的事务.\u003c/p\u003e\n\u003ch2\u003eChapter 5: Basic set Operations\u003c/h2\u003e\n\u003ch3\u003e5.1 对象选择\u003c/h3\u003e\n\u003cp\u003e使用条件表达式\u003ccode\u003ewhere-object\u003c/code\u003e 过滤枚举对象,其常用alias是\u003ccode\u003ewhere\u003c/code\u003e和\u003ccode\u003e?\u003c/code\u003e.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-powershell\"\u003e\u003cspan class=\"lineNumber\"\u003e1\u003c/span\u003e➜  ~ \u003cspan class=\"hljs-variable\"\u003e$names\u003c/span\u003e= \u003cspan class=\"hljs-selector-tag\"\u003e@\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"Aaron\"\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e\"Albert\"\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e\"Alphonse\"\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e\"Bernie\"\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e\"Charlie\"\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e\"Danny\"\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e\"Ernie\"\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e\"Frank\"\u003c/span\u003e)\n\u003cspan class=\"lineNumber\"\u003e2\u003c/span\u003e➜  ~ \u003cspan class=\"hljs-variable\"\u003e$name\u003c/span\u003e | \u003cspan class=\"hljs-built_in\"\u003eWhere-Object\u003c/span\u003e {\u003cspan class=\"hljs-variable\"\u003e$_\u003c/span\u003e \u003cspan class=\"hljs-operator\"\u003e-like\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"*yi\"\u003c/span\u003e}\n\u003cspan class=\"lineNumber\"\u003e3\u003c/span\u003eyouyi\n\u003cspan class=\"lineNumber\"\u003e4\u003c/span\u003e➜  ~ \u003cspan class=\"hljs-variable\"\u003e$name\u003c/span\u003e | \u003cspan class=\"hljs-built_in\"\u003eWhere\u003c/span\u003e {\u003cspan class=\"hljs-variable\"\u003e$_\u003c/span\u003e \u003cspan class=\"hljs-operator\"\u003e-like\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"*yi\"\u003c/span\u003e}\n\u003cspan class=\"lineNumber\"\u003e5\u003c/span\u003eyouyi\n\u003cspan class=\"lineNumber\"\u003e6\u003c/span\u003e➜  ~ \u003cspan class=\"hljs-variable\"\u003e$name\u003c/span\u003e | ? {\u003cspan class=\"hljs-variable\"\u003e$_\u003c/span\u003e \u003cspan class=\"hljs-operator\"\u003e-like\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\"*yi\"\u003c/span\u003e}\n\u003cspan class=\"lineNumber\"\u003e7\u003c/span\u003eyouyi\u003c/code\u003e\u003c/pre\u003e \n\n\u003ch3\u003e5.2 对象排序\u003c/h3\u003e\n\u003cp\u003e对可迭代对象进行升序和降序排序:\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-powershell\"\u003e\u003cspan class=\"lineNumber\"\u003e1\u003c/span\u003e➜  ~ \u003cspan class=\"hljs-variable\"\u003e$names\u003c/span\u003e= \u003cspan class=\"hljs-selector-tag\"\u003e@\u003c/span\u003e(\u003cspan class=\"hljs-string\"\u003e\"Aaron\"\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e\"Albert\"\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e\"Alphonse\"\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e\"Bernie\"\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e\"Charlie\"\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e\"Danny\"\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e\"Ernie\"\u003c/span\u003e,\u003cspan class=\"hljs-string\"\u003e\"Frank\"\u003c/span\u003e)\n\u003cspan class=\"lineNumber\"\u003e2\u003c/span\u003e➜  ~ \u003cspan class=\"hljs-variable\"\u003e$names\u003c/span\u003e | \u003cspan class=\"hljs-built_in\"\u003esort\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e3\u003c/span\u003eAaron\n\u003cspan class=\"lineNumber\"\u003e4\u003c/span\u003eAlbert\n\u003cspan class=\"lineNumber\"\u003e5\u003c/span\u003eAlphonse\n\u003cspan class=\"lineNumber\"\u003e6\u003c/span\u003eBernie\n\u003cspan class=\"lineNumber\"\u003e7\u003c/span\u003eCharlie\n\u003cspan class=\"lineNumber\"\u003e8\u003c/span\u003eDanny\n\u003cspan class=\"lineNumber\"\u003e9\u003c/span\u003eErnie\n\u003cspan class=\"lineNumber\"\u003e10\u003c/span\u003eFrank\n\u003cspan class=\"lineNumber\"\u003e11\u003c/span\u003e➜  ~ \u003cspan class=\"hljs-variable\"\u003e$names\u003c/span\u003e | \u003cspan class=\"hljs-built_in\"\u003eSort-Object\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003e-Descending\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e12\u003c/span\u003eFrank\n\u003cspan class=\"lineNumber\"\u003e13\u003c/span\u003eErnie\n\u003cspan class=\"lineNumber\"\u003e14\u003c/span\u003eDanny\n\u003cspan class=\"lineNumber\"\u003e15\u003c/span\u003eCharlie\n\u003cspan class=\"lineNumber\"\u003e16\u003c/span\u003eBernie\n\u003cspan class=\"lineNumber\"\u003e17\u003c/span\u003eAlphonse\n\u003cspan class=\"lineNumber\"\u003e18\u003c/span\u003eAlbert\n\u003cspan class=\"lineNumber\"\u003e19\u003c/span\u003eAaron\n\u003cspan class=\"lineNumber\"\u003e20\u003c/span\u003e \n\u003cspan class=\"lineNumber\"\u003e21\u003c/span\u003e\u003cspan class=\"hljs-comment\"\u003e# 指定属性\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e22\u003c/span\u003e➜  ~ \u003cspan class=\"hljs-variable\"\u003e$names\u003c/span\u003e | \u003cspan class=\"hljs-built_in\"\u003eSort-Object\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003e-Top\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003e-Property\u003c/span\u003e Length\n\u003cspan class=\"lineNumber\"\u003e23\u003c/span\u003eAaron\n\u003cspan class=\"lineNumber\"\u003e24\u003c/span\u003eDanny\n\u003cspan class=\"lineNumber\"\u003e25\u003c/span\u003eErnie\n\u003cspan class=\"lineNumber\"\u003e26\u003c/span\u003e➜  ~ \u003cspan class=\"hljs-variable\"\u003e$names\u003c/span\u003e | \u003cspan class=\"hljs-built_in\"\u003eSort-Object\u003c/span\u003e {\u003cspan class=\"hljs-variable\"\u003e$_\u003c/span\u003e.length} \u003cspan class=\"hljs-literal\"\u003e-Top\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e27\u003c/span\u003eAaron\n\u003cspan class=\"lineNumber\"\u003e28\u003c/span\u003eDanny\n\u003cspan class=\"lineNumber\"\u003e29\u003c/span\u003eErnie\u003c/code\u003e\u003c/pre\u003e \n\n\u003ch3\u003e5.3 分组排序\u003c/h3\u003e\n\u003cp\u003e可以通过设置表达式,实现分组的排序.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-powershell\"\u003e\u003cspan class=\"lineNumber\"\u003e1\u003c/span\u003e➜  ~ \u003cspan class=\"hljs-variable\"\u003e$names\u003c/span\u003e | \u003cspan class=\"hljs-built_in\"\u003eGroup-Object\u003c/span\u003e \u003cspan class=\"hljs-literal\"\u003e-Property\u003c/span\u003e length \u003cspan class=\"hljs-comment\"\u003e# group-object alias is group\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e2\u003c/span\u003e \n\u003cspan class=\"lineNumber\"\u003e3\u003c/span\u003eCount Name                      \u003cspan class=\"hljs-built_in\"\u003eGroup\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e4\u003c/span\u003e----- ----                      -----\n\u003cspan class=\"lineNumber\"\u003e5\u003c/span\u003e    \u003cspan class=\"hljs-number\"\u003e4\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e5\u003c/span\u003e                         {Aaron, Danny, Ernie, Frank}\n\u003cspan class=\"lineNumber\"\u003e6\u003c/span\u003e    \u003cspan class=\"hljs-number\"\u003e2\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e6\u003c/span\u003e                         {Albert, Bernie}\n\u003cspan class=\"lineNumber\"\u003e7\u003c/span\u003e    \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e7\u003c/span\u003e                         {Charlie}\n\u003cspan class=\"lineNumber\"\u003e8\u003c/span\u003e    \u003cspan class=\"hljs-number\"\u003e1\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e8\u003c/span\u003e                         {Alphonse}\u003c/code\u003e\u003c/pre\u003e \n\n\u003ch3\u003e5.4 对象投影\u003c/h3\u003e\n\u003cp\u003e这个小节标题让我想起当初上SQL的课的时候了.投影一个可迭代对象的部分item,可以对单独的对象进行展开操作.获取自己想要的部分数据.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-powershell\"\u003e\u003cspan class=\"lineNumber\"\u003e1\u003c/span\u003e➜  ~ \u003cspan class=\"hljs-variable\"\u003e$dir\u003c/span\u003e = \u003cspan class=\"hljs-built_in\"\u003els\u003c/span\u003e\n\u003cspan class=\"lineNumber\"\u003e2\u003c/span\u003e➜  ~ \u003cspan class=\"hljs-variable\"\u003e$dir\u003c/span\u003e | \u003cspan class=\"hljs-built_in\"\u003eselect\u003c/span\u003e name, FullName, LastAccessTime\n\u003cspan class=\"lineNumber\"\u003e3\u003c/span\u003e \n\u003cspan class=\"lineNumber\"\u003e4\u003c/span\u003eName                     FullName                               Last\n\u003cspan class=\"lineNumber\"\u003e5\u003c/span\u003e                                                                Acce\n\u003cspan class=\"lineNumber\"\u003e6\u003c/span\u003e                                                                ssTi\n\u003cspan class=\"lineNumber\"\u003e7\u003c/span\u003e                                                                me\n\u003cspan class=\"lineNumber\"\u003e8\u003c/span\u003e----                     --------                               ----\n\u003cspan class=\"lineNumber\"\u003e9\u003c/span\u003e.atom                    C:\\Users\\root\\.atom                    \u003cspan class=\"hljs-number\"\u003e202\u003c/span\u003e…\n\u003cspan class=\"lineNumber\"\u003e10\u003c/span\u003e.config                  C:\\Users\\root\\.config                  \u003cspan class=\"hljs-number\"\u003e202\u003c/span\u003e…\n\u003cspan class=\"lineNumber\"\u003e11\u003c/span\u003e.ssh                     C:\\Users\\root\\.ssh                     \u003cspan class=\"hljs-number\"\u003e202\u003c/span\u003e…\n\u003cspan class=\"lineNumber\"\u003e12\u003c/span\u003e.vscode                  C:\\Users\\root\\.vscode                  \u003cspan class=\"hljs-number\"\u003e202\u003c/span\u003e…\n\u003cspan class=\"lineNumber\"\u003e13\u003c/span\u003e\u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003eD Objects               C:\\Users\\root\\\u003cspan class=\"hljs-number\"\u003e3\u003c/span\u003eD Objects               \u003cspan class=\"hljs-number\"\u003e202\u003c/span\u003e…\n\u003cspan class=\"lineNumber\"\u003e14\u003c/span\u003eContacts                 C:\\Users\\root\\Contacts                 \u003cspan class=\"hljs-number\"\u003e202\u003c/span\u003e…\n\u003cspan class=\"lineNumber\"\u003e15\u003c/span\u003eDocuments                C:\\Users\\root\\Documents                \u003cspan class=\"hljs-number\"\u003e202\u003c/span\u003e…\n\u003cspan class=\"lineNumber\"\u003e16\u003c/span\u003eDownloads                C:\\Users\\root\\Downloads                \u003cspan class=\"hljs-number\"\u003e202\u003c/span\u003e…\n\u003cspan class=\"lineNumber\"\u003e17\u003c/span\u003eFavorites                C:\\Users\\root\\Favorites                \u003cspan class=\"hljs-number\"\u003e202\u003c/span\u003e…\n\u003cspan class=\"lineNumber\"\u003e18\u003c/span\u003eLinks                    C:\\Users\\root\\Links                    \u003cspan class=\"hljs-number\"\u003e202\u003c/span\u003e…\n\u003cspan class=\"lineNumber\"\u003e19\u003c/span\u003eMusic                    C:\\Users\\root\\Music                    \u003cspan class=\"hljs-number\"\u003e202\u003c/span\u003e…\n\u003cspan class=\"lineNumber\"\u003e20\u003c/span\u003eOneDrive                 C:\\Users\\root\\OneDrive                 \u003cspan class=\"hljs-number\"\u003e202\u003c/span\u003e…\n\u003cspan class=\"lineNumber\"\u003e21\u003c/span\u003ePictures                 C:\\Users\\root\\Pictures                 \u003cspan class=\"hljs-number\"\u003e202\u003c/span\u003e…\n\u003cspan class=\"lineNumber\"\u003e22\u003c/span\u003eSaved Games              C:\\Users\\root\\Saved Games              \u003cspan class=\"hljs-number\"\u003e202\u003c/span\u003e…\n\u003cspan class=\"lineNumber\"\u003e23\u003c/span\u003escoop                    C:\\Users\\root\\scoop                    \u003cspan class=\"hljs-number\"\u003e202\u003c/span\u003e…\n\u003cspan class=\"lineNumber\"\u003e24\u003c/span\u003eSearches                 C:\\Users\\root\\Searches                 \u003cspan class=\"hljs-number\"\u003e202\u003c/span\u003e…\n\u003cspan class=\"lineNumber\"\u003e25\u003c/span\u003eVideos                   C:\\Users\\root\\Videos                   \u003cspan class=\"hljs-number\"\u003e202\u003c/span\u003e…\n\u003cspan class=\"lineNumber\"\u003e26\u003c/span\u003e.bash_history            C:\\Users\\root\\.bash_history            \u003cspan class=\"hljs-number\"\u003e202\u003c/span\u003e…\n\u003cspan class=\"lineNumber\"\u003e27\u003c/span\u003e.bash_profile            C:\\Users\\root\\.bash_profile            \u003cspan class=\"hljs-number\"\u003e202\u003c/span\u003e…\n\u003cspan class=\"lineNumber\"\u003e28\u003c/span\u003e.bashrc                  C:\\Users\\root\\.bashrc                  \u003cspan class=\"hljs-number\"\u003e202\u003c/span\u003e…\n\u003cspan class=\"lineNumber\"\u003e29\u003c/span\u003e.bashrc.swp              C:\\Users\\root\\.bashrc.swp              \u003cspan class=\"hljs-number\"\u003e202\u003c/span\u003e…\n\u003cspan class=\"lineNumber\"\u003e30\u003c/span\u003e.gitconfig               C:\\Users\\root\\.gitconfig               \u003cspan class=\"hljs-number\"\u003e202\u003c/span\u003e…\n\u003cspan class=\"lineNumber\"\u003e31\u003c/span\u003e.git\u003cspan class=\"hljs-literal\"\u003e-for\u003c/span\u003e\u003cspan class=\"hljs-literal\"\u003e-windows\u003c/span\u003e\u003cspan class=\"hljs-literal\"\u003e-updater\u003c/span\u003e C:\\Users\\root\\.git\u003cspan class=\"hljs-literal\"\u003e-for\u003c/span\u003e\u003cspan class=\"hljs-literal\"\u003e-windows\u003c/span\u003e\u003cspan class=\"hljs-literal\"\u003e-updater\u003c/span\u003e \u003cspan class=\"hljs-number\"\u003e202\u003c/span\u003e…\n\u003cspan class=\"lineNumber\"\u003e32\u003c/span\u003e.node_repl_history       C:\\Users\\root\\.node_repl_history       \u003cspan class=\"hljs-number\"\u003e202\u003c/span\u003e…\n\u003cspan class=\"lineNumber\"\u003e33\u003c/span\u003e.viminfo                 C:\\Users\\root\\.viminfo                 \u003cspan class=\"hljs-number\"\u003e202\u003c/span\u003e…\n\u003cspan class=\"lineNumber\"\u003e34\u003c/span\u003e.vuerc                   C:\\Users\\root\\.vuerc                   \u003cspan class=\"hljs-number\"\u003e202\u003c/span\u003e…\n\u003cspan class=\"lineNumber\"\u003e35\u003c/span\u003e.yarnrc                  C:\\Users\\root\\.yarnrc                  \u003cspan class=\"hljs-number\"\u003e202\u003c/span\u003e…\n\u003cspan class=\"lineNumber\"\u003e36\u003c/span\u003e \n\u003cspan class=\"lineNumber\"\u003e37\u003c/span\u003e➜  ~\u003c/code\u003e\u003c/pre\u003e \n\n","title":"Powershell随写","date":"2020-08-03","tags":["powershell"],"mainImg":"https://images.unsplash.com/photo-1599418268698-b5a48a743a8e?crop=entropy\u0026cs=tinysrgb\u0026fit=max\u0026fm=jpg\u0026ixid=MXwxNjUyNjZ8MHwxfHJhbmRvbXx8fHx8fHx8\u0026ixlib=rb-1.2.1\u0026q=80\u0026w=1080","coverImg":"https://images.unsplash.com/photo-1599418268698-b5a48a743a8e?crop=entropy\u0026cs=tinysrgb\u0026fit=max\u0026fm=jpg\u0026ixid=MXwxNjUyNjZ8MHwxfHJhbmRvbXx8fHx8fHx8\u0026ixlib=rb-1.2.1\u0026q=80\u0026w=400","intro":"powershell 很棒,我想任何一个善用 windows 的开发者都应该学习 powershell ,系统自带环境的优势让开发者能够使用 powershell 轻松辅助开发,提高工作效率,本文献给对 powershell 感兴趣的朋友.如果你有任何关于 powershell 的内容想要与我沟通,欢迎发邮件."}},"__N_SSG":true},"page":"/posts/[slug]","query":{"slug":"Powershell随写"},"buildId":"31kFb5g2BB-p0lY747StW","assetPrefix":"/blog","nextExport":false,"isFallback":false,"gsp":true}</script><script nomodule="" src="/blog/_next/static/chunks/polyfills-86dac49abe0e0232b575.js"></script><script src="/blog/_next/static/chunks/main-bc20978b5b49cb620506.js" async=""></script><script src="/blog/_next/static/chunks/webpack-eb080e3f091731f228fb.js" async=""></script><script src="/blog/_next/static/chunks/framework.9ec1f7868b3e9d138cdd.js" async=""></script><script src="/blog/_next/static/chunks/commons.d877dcdd17afd7219ae3.js" async=""></script><script src="/blog/_next/static/chunks/6335da8543c52d3af527c387f688061357787349.7e9e1b66dd81783d6900.js" async=""></script><script src="/blog/_next/static/chunks/pages/_app-4e649ed46ef47e92b24e.js" async=""></script><script src="/blog/_next/static/chunks/2c3b9bffc7150b37a7b3810dfcf1c0b0fac2bd18.c2ce14a235a03ef7811d.js" async=""></script><script src="/blog/_next/static/chunks/pages/posts/%5Bslug%5D-ece295f9976e557edb76.js" async=""></script><script src="/blog/_next/static/31kFb5g2BB-p0lY747StW/_buildManifest.js" async=""></script><script src="/blog/_next/static/31kFb5g2BB-p0lY747StW/_ssgManifest.js" async=""></script></body></html>