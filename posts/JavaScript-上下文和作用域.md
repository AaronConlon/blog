---
title: 'JavaScript ä¸Šä¸‹æ–‡å’Œä½œç”¨åŸŸ'
date: '2022/1/9'
tags:
- JavaScript
- é¢è¯•é¢˜
mainImg: 'https://images.unsplash.com/photo-1592424002053-21f369ad7fdb?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=MnwxNjUyNjZ8MHwxfHJhbmRvbXx8fHx8fHx8fDE2NDE3MjgwMzg&ixlib=rb-1.2.1&q=80&w=1080'
coverImg: 'https://images.unsplash.com/photo-1592424002053-21f369ad7fdb?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=MnwxNjUyNjZ8MHwxfHJhbmRvbXx8fHx8fHx8fDE2NDE3MjgwMzg&ixlib=rb-1.2.1&q=80&w=400'
intro: 'JavaScript ä¸­çš„æ‰§è¡Œä¸Šä¸‹æ–‡ã€ä½œç”¨åŸŸå’Œé—­åŒ…æœºåˆ¶æ˜¯æ¯ä¸€ä¸ª JavaScript å¼€å‘è€…éƒ½å¿…é¡»äº†ç„¶äºèƒ¸çš„çŸ¥è¯†ç‚¹ï¼'
---

### å‰è¨€

`JavaScript` ä¸­çš„`æ‰§è¡Œä¸Šä¸‹æ–‡`å’Œ`ä½œç”¨åŸŸ`æ˜¯æ¯ä¸€ä¸ª `JavaScript` å¼€å‘è€…éƒ½å¿…é¡»äº†ç„¶äºèƒ¸çš„çŸ¥è¯†ç‚¹ï¼

### æ‰§è¡Œä¸Šä¸‹æ–‡ 

> Execution context(`EC`)



æ‰§è¡Œä¸Šä¸‹æ–‡å¯ä»¥è¢«ç®€ç§°ä¸º`ä¸Šä¸‹æ–‡`ï¼Œçº¢å®ä¹¦ä¸Šæœ‰æ‰€æåŠï¼šâ€œå˜é‡æˆ–å‡½æ•°çš„ä¸Šä¸‹æ–‡å†³å®šäº†å®ƒä»¬å¯ä»¥è®¿é—®å“ªäº›æ•°æ®ï¼Œä»¥åŠå®ƒä»¬çš„è¡Œä¸ºã€‚â€



æ¯ä¸€ä¸ªä¸Šä¸‹æ–‡éƒ½æœ‰ä¸€ä¸ªå…³è”çš„`variable object`ï¼Œè¿™ä¸ªä¸Šä¸‹æ–‡ä¸­å®šä¹‰çš„å˜é‡å’Œå‡½æ•°éƒ½ä¿å­˜åœ¨è¿™ä¸ªå˜é‡å¯¹è±¡ä¸Šã€‚



ä¸Šä¸‹æ–‡åˆ†ä¸ºå…¨å±€ä¸Šä¸‹æ–‡å’Œå‡½æ•°ä¸Šä¸‹æ–‡ï¼ˆä»¥åŠè¾ƒå°‘æåŠçš„ eval å‡½æ•°ä¸Šä¸‹æ–‡ï¼‰ï¼Œ`å…¨å±€ä¸Šä¸‹æ–‡`ä¿å­˜äº†æ‰€æœ‰éå‡½æ•°å†…çš„å˜é‡å’Œå‡½æ•°ï¼Œä¸€ä¸ªç¨‹åºåªä¼šæœ‰ä¸€ä¸ªå…¨å±€ä¸Šä¸‹æ–‡ã€‚



æˆ‘ä»¬é€šå¸¸ç§°å…¨å±€ä¸Šä¸‹æ–‡å¯¹è±¡ä¸º`globalThis`å¯¹è±¡ï¼Œè¿™æŠ¹å¹³äº†æµè§ˆå™¨å’Œ Node ç«¯çš„å˜é‡åå·®å¼‚ï¼Œå½“ç„¶åœ¨æµè§ˆå™¨ç«¯ï¼Œ`window`å³`globalThis`ã€‚



> ä½¿ç”¨`var`å®šä¹‰çš„é¡¶çº§å£°æ˜ä¼šè‡ªåŠ¨æˆä¸º`globalThis`çš„å±æ€§å’Œæ–¹æ³•ï¼Œä½¿ç”¨`let`ã€`const`åˆ™ä¸ä¼šï¼Œæˆ‘ä»¬ä¹‹æ‰€ä»¥èƒ½è®¿é—®åˆ°é¡¶çº§`let/const`å®šä¹‰çš„å˜é‡å¹¶ä¸æ˜¯å› ä¸ºå…¶ä½œä¸º`globalThis`çš„å±æ€§æˆ–æ–¹æ³•ï¼Œä¸è¦æ··ä¸ºä¸€è°ˆã€‚



å½“å‡½æ•°è¢«`è°ƒç”¨`çš„æ—¶å€™ï¼Œè§£é‡Šå™¨éƒ½ä¼šä¸ºå…¶åˆ›å»ºä¸€ä¸ª`å‡½æ•°æ‰§è¡Œä¸Šä¸‹æ–‡`ï¼Œæ¯ä¸€ä¸ªå‡½æ•°éƒ½æœ‰è‡ªå·±çš„æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œå†æ¬¡å¼ºè°ƒï¼šæ¯ä¸€æ¬¡`è°ƒç”¨`éƒ½ä¼šåˆ›å»ºæ–°çš„æ‰§è¡Œä¸Šä¸‹æ–‡ï¼Œå¹¶ä¸”åœ¨éç®­å¤´å‡½æ•°è¢«è°ƒç”¨æ—¶ï¼Œé»˜è®¤åœ¨å‡½æ•°ä¸Šä¸‹æ–‡çš„å˜é‡å¯¹è±¡ä¸­åˆå§‹åŒ–`arguments`å’Œ`this`çš„å€¼ã€‚



ä¼´éšç€å‡½æ•°çš„æ‰§è¡Œï¼Œè¿˜éœ€è¦è®°ä½`æ‰§è¡Œä¸Šä¸‹æ–‡æ ˆ`çš„æ¦‚å¿µï¼Œæ¯ä¸€ä¸ªå‡½æ•°ä¸Šä¸‹æ–‡éƒ½æŒ‰å‡½æ•°è°ƒç”¨çš„ç”Ÿå‘½å‘¨æœŸå‹å…¥æ ˆä¸­ï¼Œå…¨å±€ä¸Šä¸‹æ–‡åˆ™åœ¨æ ˆåº•ã€‚

å½“å½“å‰æ‰§è¡Œçš„å‡½æ•°ç»“æŸï¼Œåˆ™å°†å…¶å‡½æ•°ä¸Šä¸‹æ–‡å‡ºæ ˆï¼Œæ¥ç€æ‰§è¡Œä¸‹ä¸€ä¸ªå‡½æ•°æˆ–ä»£ç å—ã€‚

ä¸¾ä¸ªä¾‹å­ï¼š

```js
const a = 10;
function foo() {
  console.log('Start func foo!')
  function bar() {
    console.log('Start func bar!')
  }
  bar();
}
foo();
console.log('GlobalContext');
```

è¿™æ®µç®€çŸ­çš„ä»£ç å—åœ¨æ‰§è¡Œçš„æ—¶å€™ï¼Œå…ˆå°†å…¨å±€ä¸Šä¸‹æ–‡å­˜å…¥ä¸Šä¸‹æ–‡æ ˆçš„æ ˆåº•ï¼Œç„¶åè°ƒç”¨å‡½æ•°`foo`ï¼Œäºæ˜¯å°†`foo`å‡½æ•°çš„å‡½æ•°ä¸Šä¸‹æ–‡å‹å…¥æ‰§è¡Œä¸Šä¸‹æ–‡æ ˆï¼Œåœ¨`foo`å‡½æ•°æ‰§è¡Œçš„æ—¶å€™ï¼Œåˆè°ƒç”¨äº†å†…éƒ¨å‡½æ•°`bar`ï¼Œäºæ˜¯ç»§ç»­å°†`bar`çš„å‡½æ•°ä¸Šä¸‹æ–‡å‹å…¥æ‰§è¡Œæ ˆä¸­ã€‚



### ä½œç”¨åŸŸ

ä½œç”¨åŸŸè·Ÿå˜é‡æ˜¯å¯¹åº”å…³ç³»ï¼Œæ¯ä¸€ä¸ªå˜é‡éƒ½æœ‰è‡ªå·±çš„ä½œç”¨åŸŸã€‚

äº¦æœ‰äººç§°ä½œç”¨åŸŸå³æºä»£ç ä¸­å®šä¹‰å˜é‡çš„åŒºåŸŸï¼Œä½œç”¨åŸŸè§„å®šäº†å¦‚ä½•æŸ¥æ‰¾å˜é‡ï¼Œå¹¶ä¸”ç¡®å®šå½“å‰æ‰§è¡Œä»£ç å¯¹å˜é‡çš„è®¿é—®æƒé™ï¼Œåœ¨ JavaScript ä¸­é‡‡ç”¨`lexical scoping`è¯æ³•ä½œç”¨åŸŸï¼Œä¹Ÿè¢«ç§°ä¸ºé™æ€ä½œç”¨åŸŸã€‚



åœ¨`ES6`ä¹‹å‰ï¼Œä½œç”¨åŸŸåˆ†ä¸ºå…¨å±€ä½œç”¨åŸŸå’Œå‡½æ•°ä½œç”¨åŸŸï¼Œ`ES6`æ–°å¢äº†`å—çº§ä½œç”¨åŸŸ`çš„æ¦‚å¿µï¼Œç”¨ä»¥éš”ç¦»å˜é‡ï¼Œåˆ’åˆ†ä½œç”¨åŸŸä»¥é˜²æ­¢åŒåå˜é‡å†²çªã€‚

æ¥çœ‹ä¸€å¼ èƒ½æç°ä½œç”¨åŸŸåˆ†å±‚çš„ä»£ç å›¾ç¤ºï¼Œå–è‡ª FunDebug åšå®¢ï¼š

![](https://image.fundebug.com/2019-03-15-WechatIMG465.png)

æ‰§è¡Œå‡½æ•°æ—¶ï¼Œå†…éƒ¨å˜é‡å–å€¼è¦ä»å…¶ä½œç”¨åŸŸä¸­å…ˆæŸ¥æ‰¾å€¼ï¼Œç„¶åé€çº§ä»å®šä¹‰å‡½æ•°çš„ä½ç½®å¾€ä¸ŠæŸ¥æ‰¾ä¸Šçº§ä½œç”¨åŸŸä¸­æ˜¯å¦æœ‰æ­¤å˜é‡ï¼Œç›´åˆ°æŸ¥è‡³å…¨å±€ä½œç”¨åŸŸï¼Œå¦‚è‹¥æŸ¥ä¸åˆ°æ­¤å˜é‡åˆ™æŠ¥é”™å˜é‡ä¸å­˜åœ¨ã€‚



### ä½œç”¨åŸŸå’Œä¸Šä¸‹æ–‡

ä½œç”¨åŸŸä¸ç­‰äºä¸Šä¸‹æ–‡ã€‚

JavaScript ä½œä¸ºè§£é‡Šå‹è¯­è¨€ï¼Œå…¶ç¨‹åºè¿è¡Œåˆ†ä¸º`è§£é‡Š`å’Œ`æ‰§è¡Œ`ä¸¤ä¸ªé˜¶æ®µã€‚

è§£é‡Šé˜¶æ®µè´Ÿè´£ï¼š

- è¯æ³•åˆ†æ
- è¯­æ³•åˆ†æ
- ä½œç”¨åŸŸè§„åˆ™ç¡®å®š

æ‰§è¡Œé˜¶æ®µè´Ÿè´£ï¼š

- åˆ›å»ºä¸Šä¸‹æ–‡
- æ‰§è¡Œä»£ç 
- åƒåœ¾å›æ”¶â™»ï¸

åœ¨è§£é‡Šé˜¶æ®µï¼Œä½œç”¨åŸŸä¾¿ç¡®å®šäº†ï¼Œå› æ­¤åœ¨å‡½æ•°æ‰§è¡Œæ—¶æˆ‘ä»¬è¦æ³¨æ„å˜é‡å–å€¼çš„æ¥æºï¼Œä»¥å…é€ æˆè¯¯è§£ã€‚

ä¸Šä¸‹æ–‡åˆ™æ˜¯åœ¨å‡½æ•°æ‰§è¡Œä¹‹å‰åˆ›å»ºï¼Œæœ€æ˜æ˜¾çš„æ˜¯`this`çš„æŒ‡å‘æ˜¯åœ¨è¿™ä¸ªæ—¶å€™ç¡®å®šçš„ï¼Œè·Ÿè§£é‡Šé˜¶æ®µæ— å…³ã€‚

å¼•ç”¨`funDebug`ä¸€å¥è¯ï¼š

> `æ‰§è¡Œä¸Šä¸‹æ–‡åœ¨è¿è¡Œæ—¶ç¡®å®šï¼Œéšæ—¶å¯èƒ½æ”¹å˜ï¼›ä½œç”¨åŸŸåœ¨å®šä¹‰æ—¶å°±ç¡®å®šï¼Œå¹¶ä¸”ä¸ä¼šæ”¹å˜ã€‚`

ä¸åŒçš„è°ƒç”¨ä¼šäº§ç”Ÿä¸åŒçš„ä¸Šä¸‹æ–‡ï¼Œå› æ­¤å–å¾—ä¸åŒçš„å˜é‡å€¼ä¾¿é¡ºç†æˆç« äº†ã€‚



### å‚è€ƒ

- [æ·±å…¥ç†è§£ JavaScript ä½œç”¨åŸŸå’Œä½œç”¨åŸŸé“¾ | Fundebugåšå®¢](https://blog.fundebug.com/2019/03/15/understand-javascript-scope/)
- [JavaScript Execution Context - DEV Community ğŸ‘©â€ğŸ’»ğŸ‘¨â€ğŸ’»](https://dev.to/luigircruz/javascript-execution-context-38cn)
- [Execution context, Scope chain and JavaScript internals | by Rupesh Mishra | Medium](https://medium.com/@happymishra66/execution-context-in-javascript-319dd72e8e2c)

