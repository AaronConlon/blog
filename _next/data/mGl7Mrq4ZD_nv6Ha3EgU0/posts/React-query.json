{"pageProps":{"post":{"slug":"React-query","content":"\nI hope to use simple examples to record everything about react-query.\n\nThank you! [React Query Tutorial - 1 - Introduction - YouTube](https://www.youtube.com/watch?v=VtWkSCZX0Ec&list=PLC3y8-rFHvwjTELCrPrcZlo6blLBUspd2&index=1)\n\nContent of table:\n\n- Fetching data with useQuery\n- Handleing query error\n- Devtools\n- Query cache\n- Stable time\n- Refetch defaults\n- Polling data\n- Click event and useQuery\n- Success and error callbacks\n- Data Ttransformation\n- Custon query hook\n- Query by Id\n- Parallel queries\n- Dynamic parallel query\n- Dependent queries\n- Infinite query data\n- Pagination queires\n- Inifite queries\n- Mutations\n- Query invalidation\n- Handing mutation response\n- Optimistic updates\n- Axios Interceptor\n\n\n\n## Fetching data with useQuery\n\nLet's create a query:\n\n ```jsx\n const fetchTodos = async () => {\n   return axios.get(\"https://localhost:4000/todos\")\n }\n // give a unique identify key and a fetch function\n const response = useQeury('todo-list', fetchTodos);\n ```\n\n> `todo-list` is a unique key to identify your query, fetchTodos is your fetch function.\n\nNow,we get a response object.It's contains:\n\n- isLoading: web request loading status\n- data: response data\n- more...\n\n## Handling query error\n\nAgain.\n\n```jsx\nconst fetchTodos = async () => {\n  return axios.get(\"https://localhost:4000/todossss\")\n}\nconst {isLoading, data, isError, error} = useQuery('todo-list', fetchTodos);\n```\n\nOk,We got a `error` message and a status:\"`isError`\"!\n\nWhy?Beacuse my request url is wrong.It was a 404 page.\n\nYou can display the `error` message in your app.\n\n\n\n## Devtools\n\nIf you use react to build your web application with react-qeury,you can use `reactQueryDevTools` in your queryClientProvidr.\n\nExample:\n\n```jsx\n<QeuryClientProvider client={client}>\n  <ReactQueryDevTools initialIsOpen={false} position='bottom-right' />\n</QeuryClientProvider>\n```\n\nAnd then,you can see a react-query logo at the position of bottom-right.\n\nUse this devtools, you can see the network process and action result.Also, you can refetch,invalidate,reset or remove your action.\n\n\n\n## Query cache\n\nSometimes,we just want to see one time about our loading status or loading tip.\n\nWhen our query action is fetching,the `isFetch` flag is true:\n\n> default cache time is 5 minutes!\n\n```jsx\nconst fetchTodos = async () => {\n  return axios.get(\"https://localhost:4000/todossss\")\n}\nconst options = {\n  cacheTime: 5000\n}\nconst {isLoading, data, isError, error, isFetching} = useQuery('todo-list', fetchTodos, options);\n```\n\nNow we add a options object to control our query action.We can add cacheTime to control query data cache.After 5s ,the query will refetch api and update data and other properties.\n\n\n\n## Stale time\n\nIf we hope our query data is stale.We can config a stale time.\n\n> default stale time is zero second!\n\n```js\nconst fetchTodos = async () => {\n  return axios.get(\"https://localhost:4000/todossss\")\n}\nconst options = {\n  staleTime: 30000\n}\nconst {isLoading, data, isError, error, isFetching} = useQuery('todo-list', fetchTodos, options);\n```\n\n> staleTime is 30s,we will not refetch data in 30s.If your config a cashe time also,the cashe time will be ignore.\n","title":"React-query","date":"2022/4/19","tags":["React","React-query"],"mainImg":"https://images.unsplash.com/photo-1599837565318-67429bde7162?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=MnwxNjUyNjZ8MHwxfHJhbmRvbXx8fHx8fHx8fDE2NTAyOTgwNTU&ixlib=rb-1.2.1&q=80&w=1080","coverImg":"https://images.unsplash.com/photo-1599837565318-67429bde7162?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=MnwxNjUyNjZ8MHwxfHJhbmRvbXx8fHx8fHx8fDE2NTAyOTgwNTU&ixlib=rb-1.2.1&q=80&w=400","intro":"React-query is a awesome library for fetching data in react application."}},"__N_SSG":true}