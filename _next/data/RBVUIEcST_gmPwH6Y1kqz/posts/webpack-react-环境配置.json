{"pageProps":{"post":{"slug":"webpack-react-ç¯å¢ƒé…ç½®","content":"\nè¿™ä»½é…ç½®åŒ…æ‹¬ä»¥ä¸‹å‡ ç‚¹ï¼š\n\n- babel presets\n- webpack dev server\n- Hot module replacement\n- miniCssExtractPlugin\n- postCss\n- Eslint autofix + Prettier\n\n## åˆå§‹åŒ–\n\n```bash\nyarn init -y\nyarn add react react-dom\nyarn add -D webpack webpack-cli webpack-dev-server@next\n// init webpack config\nnpx webpack init\n```\n\næ ¹æ®éœ€æ±‚å¡«å†™äº¤äº’ï¼Œæœ€åå¾—åˆ°é…ç½®æ–‡ä»¶`webpack.config.js`:\n\n```js\n// Generated using webpack-cli https://github.com/webpack/webpack-cli\n\nconst path = require(\"path\");\nconst HtmlWebpackPlugin = require(\"html-webpack-plugin\");\nconst MiniCssExtractPlugin = require(\"mini-css-extract-plugin\");\n\nconst isProduction = process.env.NODE_ENV == \"production\";\nconst stylesHandler = MiniCssExtractPlugin.loader;\nconst config = {\n  entry: \"./src/index.js\",\n  output: {\n    path: path.resolve(__dirname, \"dist\"),\n  },\n  devServer: {\n    open: true,\n    host: \"localhost\",\n    hot: true,\n  },\n  plugins: [\n    new HtmlWebpackPlugin({\n      template: \"index.html\",\n    }),\n\n    // Add your plugins here\n    // Learn more about plugins from https://webpack.js.org/configuration/plugins/\n  ],\n  module: {\n    rules: [\n      {\n        test: /\\.(js|jsx)$/i,\n        loader: \"babel-loader\",\n      },\n      {\n        test: /\\.s[ac]ss$/i,\n        use: [stylesHandler, \"css-loader\", \"postcss-loader\", \"sass-loader\"],\n      },\n      {\n        test: /\\.(eot|svg|ttf|woff|woff2|png|jpg|gif)$/i,\n        type: \"asset\",\n      },\n\n      // Add your rules for custom modules here\n      // Learn more about loaders from https://webpack.js.org/loaders/\n    ],\n  },\n};\n\nmodule.exports = () => {\n  if (isProduction) {\n    config.mode = \"production\";\n\n    config.plugins.push(\n      new MiniCssExtractPlugin({\n        filename: \"css/[name].[hash].css\",\n      })\n    );\n  } else {\n    config.mode = \"development\";\n  }\n  return config;\n};\n```\n\né¡ºåˆ©å®‰è£…åï¼Œæˆ‘ä»¬å°±å®ç°äº†éœ€æ±‚ï¼Œæ¥åˆ†æåˆ†æè¿™ä»½é…ç½®æ–‡ä»¶ï¼š\n\n- æ ¹æ® node ç¯å¢ƒè®¾ç½®å¼€å‘æ¨¡å¼\n- ä½¿ç”¨`miniCssExtractPlugin`æ¥å•ç‹¬æå–`css`æ–‡ä»¶\n- ä½¿ç”¨`babel`å¤„ç†`js`æ–‡ä»¶\n- è‡ªåŠ¨é…ç½®`postCss`æ”¯æŒå‚å•†å‰ç¼€è‡ªåŠ¨ä¿®å¤\n- å®‰è£…`prettier`æ ¼å¼åŒ–ä»£ç ï¼Œä¿è¯ä»£ç é£æ ¼\n- é»˜è®¤åˆå§‹åŒ–`scripts`ï¼Œæ”¯æŒå¼€å‘æ¨¡å¼åˆ‡æ¢\n- æ”¯æŒ`sass`çš„å¼€å‘å’Œç¼–è¯‘\n\nè¿™æ˜¯æœ€åŸºç¡€çš„åŠŸèƒ½ï¼Œ`webpack-cli`å°±èƒ½å¾ˆå¥½çš„æ”¯æŒåˆ°ã€‚\n\næ¥ä¸‹æ¥å°±æ˜¯é…ç½®`babel`ç›¸å…³çš„ç‰¹æ€§ï¼Œä¸ºäº†æ”¯æŒ`react`çš„`jsx`å†™æ³•ï¼Œéœ€è¦ä½¿ç”¨`@babel/preset-react`çš„åŠŸèƒ½ï¼š\n\né¦–å…ˆåŠ¡å¿…å®‰è£…`balel`ä¸€ç³»åˆ—çš„åŒ…ï¼Œå¹¶ä¸”é…ç½®å¥½`.babelrc`:\n\n```bash\nyarn add @babel/core @babel/preset-env @babel/preset-react babel-loader\n```\n\n`.babelrc`:\n\n```js\n{\n    \"plugins\": [\"@babel/syntax-dynamic-import\"],\n    \"presets\": [\n        [\n            \"@babel/preset-env\",\n            {\n                \"useBuiltIns\": \"usage\",\n                \"corejs\": {\n                  \"version\": \"3.16\",\n                  \"proposals\": false,\n                },\n            }\n        ],\n        \"@babel/preset-react\"\n    ]\n}\n```\n\n`@babel/preset-env`è¿˜è¦æ³¨æ„çš„ä¸€ä¸ªç‚¹æ˜¯ä»£ç é¢„ç½®éœ€è¦ä¸€ä¸ª`targets`ï¼Œç”¨äºæŒ‡å®šä»£ç é¢„ç½®çš„ç›®æ ‡ï¼Œä¾‹å¦‚æˆ‘ä»¬åªéœ€è¦æ”¯æŒåˆ°æœ€æ–°ç‰ˆæœ¬çš„`chrome`ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡`.browserslistrc`é…ç½®æ–‡ä»¶è®¾ç½®ï¼Œ`webpack-cli`ä¼šè¯»å–è¿™ä¸ªæ–‡ä»¶çš„é…ç½®ï¼Œå¹¶ä¸”æ­¤æ–‡ä»¶è¿˜å¯ä»¥å’Œå¤šä¸ªåº“åä½œï¼Œä¾‹å¦‚`postcss`ç­‰ç¬¬ä¸‰æ–¹åº“éƒ½èƒ½æ— ç¼ä½¿ç”¨å…¶é…ç½®ã€‚\n\nå¦‚æœä¸é…ç½®ï¼Œåˆ™ä½¿ç”¨é»˜è®¤å€¼ã€‚`npx browserslist 'default'`èƒ½å¤ŸæŸ¥çœ‹å½“å‰ç‰ˆæœ¬çš„é»˜è®¤å€¼ï¼š\n\n```bash\nand_chr 92\nand_ff 90\nand_qq 10.4\nand_uc 12.12\nandroid 92\nbaidu 7.12\nchrome 92\nchrome 91\nchrome 90\nedge 92\nedge 91\nfirefox 90\nfirefox 89\nfirefox 78\nie 11\nios_saf 14.5-14.7\nios_saf 14.0-14.4\nkaios 2.5\nop_mini all\nop_mob 64\nopera 77\nopera 76\nsafari 14.1\nsafari 14\nsafari 13.1\nsamsung 14.0\nsamsung 13.0\n```\n\nè¯¦æƒ…å¯æŸ¥çœ‹[browserslist/browserslist: Share target browsers ... - GitHubhttps://github.com â€º browserslist â€º browserslist](https://github.com/browserslist/browserslist)ã€‚\n\nå¦‚æ­¤ä¸€æ¥ï¼Œæˆ‘ä»¬ä¾¿å°†ä»£ç é¢„ç½®ç¯å¢ƒå’Œ`polyfill`é…ç½®å¥½äº†ã€‚\n\n`@babel/preset-env`çš„`polyfill`æ–¹æ¡ˆä¼šæ±¡æŸ“å…¨å±€ç¯å¢ƒï¼Œå¹¶ä¸”ç›¸å…³çš„`helper`å‡½æ•°å¤ç”¨è¾ƒå·®å¯¼è‡´æ‰“åŒ…ä½“ç§¯è¾ƒå¤§ï¼Œä½†æ˜¯ç”±äºç›®å‰å¹¶ä¸éœ€è¦å¼€å‘åº“ï¼Œå› æ­¤åœ¨è¿™é‡Œå°±ä¸ç»†ç©¶`@babel/plugin-transform-runtime`äº†ã€‚\n\n## ä»£ç æ£€æŸ¥\n\nä»£ç æ£€æŸ¥åŒ…æ‹¬è¯­æ³•æ£€æŸ¥å’Œä»£ç é£æ ¼æ£€æŸ¥ï¼Œ`eslint`è´Ÿè´£ä¸»è¦è¯­æ³•æ£€æŸ¥ï¼Œå¹¶ä¸”åœ¨ä»£ç é£æ ¼æ–¹é¢ä½¿ç”¨`airbnb`çš„è§„èŒƒçš„åŒæ—¶ï¼Œä¸`prettier`å†²çªçš„éƒ¨åˆ†ç”±`prettier`çš„è§„åˆ™å†³å®šã€‚\n\næœ€åï¼Œåœ¨ä»£ç æäº¤ä¹‹å‰è¿›è¡Œ`prettier`ä»£ç æ ¼å¼åŒ–ã€‚\n\né¦–å…ˆæ¥çœ‹çœ‹`prettier`å’Œ`eslint`çš„é…ç½®æ–‡ä»¶ï¼š\n\n```js\n// prettier\nmodule.exports = {\n  semi: true,\n  singleQuote: true,\n};\n\n// eslint\nmodule.exports = {\n  env: {\n    browser: true,\n    es2021: true,\n  },\n  extends: [\"plugin:react/recommended\", \"airbnb\", \"prettier\"],\n  parserOptions: {\n    ecmaFeatures: {\n      jsx: true,\n    },\n    ecmaVersion: 12,\n    sourceType: \"module\",\n  },\n  plugins: [\"react\"],\n  rules: {\n    \"no-console\": \"off\",\n    \"react/jsx-filename-extension\": [1, { extensions: [\".js\", \".jsx\"] }],\n  },\n};\n```\n\n`.eslintrc.js`æ˜¯é€šè¿‡`npx eslint --init`åˆ›å»ºçš„ï¼Œåªæ˜¯æ·»åŠ äº†`eslint-config-prettier`æ¥æ¶ˆé™¤`eslint`å’Œ`prettier`çš„å†²çªã€‚\n\nå¦‚æ­¤ä¸€æ¥ï¼Œä»£ç åœ¨ç¼–è¾‘çš„æ—¶å€™å°±èƒ½å¤Ÿæ”¯æŒåˆ°è‡ªåŠ¨æ ¼å¼åŒ–å’Œé”™è¯¯æç¤ºäº†ã€‚\n\nè¡¥å……ä¸€ç‚¹ï¼Œä½¿ç”¨`stylelint`æ¥è§„èŒƒæˆ‘ä»¬çš„`sass`æ ·å¼è¡¨ã€‚\n\né¦–å…ˆéœ€è¦å®‰è£…ï¼š\n\n`yarn add -D stylelint stylelint-scss`\n\né’ˆå¯¹æ€§çš„ï¼Œç›®å‰æˆ‘åªéœ€è¦å†™ä¸€äº›å•ç‹¬çš„`sass`æ–‡ä»¶ï¼Œå› æ­¤åªéœ€è¦ä½¿ç”¨æ­¤æ’ä»¶æ¥å®ç°ä»£ç é£æ ¼æ£€æŸ¥ï¼Œå¦‚æœåç»­éœ€è¦å†™`styled-component`ï¼Œåˆ™å¯ä»¥å¯»æ‰¾å…¶æ‰©å±•ã€‚\n\nå¦å¤–ï¼Œä¾ç„¶æ¨èä½¿ç”¨[hudochenkov/stylelint-order: A plugin pack of order related linting rules for stylelint.](https://github.com/hudochenkov/stylelint-order)è¿™ä¸ªè¯­æ³•æ’åºçš„æ’ä»¶ï¼Œèƒ½å¤Ÿè®©æˆ‘ä»¬çš„ä»£ç ä¿æŒé¡ºåºå’Œæé«˜å¯è¯»æ€§ï¼Œå¦å¤–é¡ºåºçš„è§„åˆ™æœ€å¥½é…åˆ[ream88/stylelint-config-idiomatic-order: stylelint + idiomatic-css = â¤ï¸](https://github.com/ream88/stylelint-config-idiomatic-order)ä½¿ç”¨ã€‚\n\næœ€åï¼Œä¸ºäº†è®©`prettier`æ ¼å¼åŒ–çš„æ—¶å€™ä¸è·Ÿ`stylelint`å†²çªï¼Œæˆ‘ä»¬éœ€è¦ï¼š[prettier/stylelint-config-prettier: Turns off all rules that are unnecessary or might conflict with prettier.](https://github.com/prettier/stylelint-config-prettier)çš„æ”¯æŒï¼Œåœ¨`.stylelintrc`ä¸­æ·»åŠ æœ€åä¸€ä¸ªæ‰©å±•é…ç½®ã€‚\n\n## Git æäº¤\n\næœ€åæ˜¯`åœ¨ git æäº¤ä¹‹å‰æ ¼å¼åŒ–ä»£ç ï¼Œå¹¶ä¸”è§„èŒƒåŒ– git info body`ã€‚\n\næˆ‘ä»¬å°†ä½¿ç”¨`lint-staged`å’Œ`husky`æ¥å®ç°è¿™ä¸ªéœ€æ±‚ã€‚\n\nä¸€æŠŠæ¢­ï¼š\n\n`npx mrm@2 lint-staged`å¯ä»¥æ ¹æ®æˆ‘ä»¬å·²ç»é…ç½®å¥½çš„å„ç§`linter`çš„é…ç½®ï¼Œç”Ÿæˆ`package.json`ä¸­çš„`lint-staged`é…ç½®ï¼Œè°ƒç”¨å„ç§`linter`å»å¤„ç†ç›®æ ‡æ–‡ä»¶ã€‚\n\næœ€åï¼Œè¿˜éœ€è¦å¼•å…¥`commitlint`æ¥è§„èŒƒæäº¤çš„`git`ä¿¡æ¯ã€‚\n\nå…¨å±€å®‰è£…å¥½è¿™ä¸ªéå¸¸æœ‰ç”¨çš„å·¥å…·ï¼Œå¹¶ä¸”åˆå§‹åŒ–ä¸€ä»½ç®€å•çš„é…ç½®æ–‡ä»¶ï¼š\n\n```bash\n// install package\nnpm install -g @commitlint/cli @commitlint/config-conventional\n// init config\necho \"module.exports = {extends: ['@commitlint/config-conventional']}\" > commitlint.config.js\n```\n\næœ€åï¼Œæˆ‘ä»¬æ‰‹åŠ¨æ·»åŠ ä¸€ä¸ª`commitlint`çš„`hooks`:\n\n```bash\n# Add hook\nnpx husky add .husky/commit-msg 'npx --no-install commitlint --edit $1'\n# or\nyarn husky add .husky/commit-msg 'yarn commitlint --edit $1'\n```\n\n## ä¼˜åŒ–\n\n- Friendly-errors-webpack-plugin ä¼˜åŒ–è¾“å‡ºä¿¡æ¯\n- [gitignore.io - ä¸ºä½ çš„é¡¹ç›®åˆ›å»ºå¿…è¦çš„ .gitignore æ–‡ä»¶](https://www.toptal.com/developers/gitignore)\n- å…¶ä»–\n","title":"webpack-react-ç¯å¢ƒé…ç½®","date":"2021/8/8","tags":["å·¥ç¨‹åŒ–"],"mainImg":"https://images.unsplash.com/photo-1603302576837-37561b2e2302?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=MnwxNjUyNjZ8MHwxfHJhbmRvbXx8fHx8fHx8fDE2Mjg0MTc2NjE&ixlib=rb-1.2.1&q=80&w=1080","coverImg":"https://images.unsplash.com/photo-1603302576837-37561b2e2302?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=MnwxNjUyNjZ8MHwxfHJhbmRvbXx8fHx8fHx8fDE2Mjg0MTc2NjE&ixlib=rb-1.2.1&q=80&w=400","intro":"ä¸€ä»½æ‰‹åŠ¨é…ç½®çš„ react å¼€å‘ç¯å¢ƒé…ç½®è®°å½•ğŸ“ã€‚"}},"__N_SSG":true}