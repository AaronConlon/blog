{"pageProps":{"post":{"slug":"å®ç°ä¸€ä¸ªPromise-A+è§„èŒƒçš„Promiseç±»","contentHtml":"<p>æˆ‘ä¹‹æ‰€ä»¥åšè¿™ä»¶äº‹æ˜¯å› ä¸ºæˆ‘æƒ³æ›´æ·±å…¥ç†è§£ <code>Promise</code> çš„è®¾è®¡ç†å¿µå’Œè®¾è®¡åŸç†ï¼Œæˆ‘çœ‹äº†ä¸€äº›æ–‡ç« å’Œä»‹ç»ï¼Œæœç´¢äº†ä¸€äº›çŸ¥è¯†ï¼Œä¹Ÿå­¦ä¹ äº†å…¶ä»–äººçš„ <code>Promise</code>å®ç°æºç ã€‚</p>\n<p>è¿™çœŸçš„å¾ˆä»¤æˆ‘æŒ¯å¥‹ï¼Œé€šè¿‡å®ç°ä¸€ä¸ªç¬¦åˆ<code>Promise/A+</code>è§„èŒƒçš„<code>Promise</code>ç±»ï¼Œæˆ‘å¯¹<code>Promise</code>çš„ç†è§£æœ‰äº†ä¸é”™çš„è¿›æ­¥ï¼Œé‚£å°±åºŸè¯å°‘è¯´ï¼Œå¼€å§‹å§ã€‚</p>\n<h3>æ€è€ƒğŸ¤”</h3>\n<p>åœ¨æˆ‘ä»¬å¼€å§‹ä¹‹å‰ï¼Œå‡è®¾æˆ‘ä»¬å¤„äºä¸€ä¸ªå¯†é—­ç©ºé—´ï¼Œè§¦æ‰‹å¯åŠçš„åªæœ‰æ‰‹å¤´çš„é”®ç›˜ã€‚</p>\n<p>æƒ³æƒ³ï¼Œç”¨å°‘é‡è¯æ±‡ç»„ç»‡å°†è¦å†™çš„ä»£ç çš„å†…å®¹ï¼Œä¾‹å¦‚ï¼š</p>\n<ul>\n<li>æˆ‘çš„ Promise å®ç°å‘½åä¸º<code>Yi</code></li>\n<li><code>Yi</code>åˆå§‹å€¼ä¸º<code>undefined</code>ï¼Œåˆå§‹çŠ¶æ€ä¸º<code>pending</code>ï¼ŒçŠ¶æ€å¯ä»¥è½¬å˜ä¸º<code>fulfilled</code>æˆ–è€…<code>rejected</code>,çŠ¶æ€æ”¹å˜åä¸å¯é€†ï¼ŒçŠ¶æ€æ”¹å˜çš„é€»è¾‘åªæ‰§è¡Œä¸€æ¬¡ã€‚</li>\n<li><code>Yi</code>å…·å¤‡ä¸¤ä¸ªé™æ€æ–¹æ³•ï¼š<code>resolve</code>å’Œ<code>reject</code>ï¼Œå½“çŠ¶æ€ä¸º<code>pending</code>æ—¶æ‰æ‰§è¡Œé€»è¾‘ï¼Œè¿™æ ·æ‰§è¡Œä¸€æ¬¡ä¹‹åå°±ç›´æ¥è¿”å›ï¼Œæ‰§è¡Œè¿™ä¸¤ä¸ªæ–¹æ³•éƒ½ä¼š</li>\n</ul>\n<p>å¾ˆå¿«ï¼Œæˆ‘ä»¬çš„å®ç°å¯èƒ½å¦‚ä¸‹ï¼š</p>\n<pre><code class=\"hljs language-js\"><span class=\"lineNumber\">1</span><span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">Yi</span>(<span class=\"hljs-params\">executor</span>) </span>{\n<span class=\"lineNumber\">2</span>  <span class=\"hljs-built_in\">this</span>.state = <span class=\"hljs-string\">'pending'</span>\n<span class=\"lineNumber\">3</span>  <span class=\"hljs-built_in\">this</span>.value = <span class=\"hljs-literal\">undefined</span>\n<span class=\"lineNumber\">4</span>  executor(<span class=\"hljs-built_in\">this</span>.resolve.bind(<span class=\"hljs-built_in\">this</span>), <span class=\"hljs-built_in\">this</span>.reject.bind(<span class=\"hljs-built_in\">this</span>))\n<span class=\"lineNumber\">5</span>}\n<span class=\"lineNumber\">6</span> \n<span class=\"lineNumber\">7</span>Yi.prototype.resolve = <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">value</span>) </span>{\n<span class=\"lineNumber\">8</span>  <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-built_in\">this</span>.state !== <span class=\"hljs-string\">'pending'</span>) <span class=\"hljs-keyword\">return</span>\n<span class=\"lineNumber\">9</span>  <span class=\"hljs-built_in\">this</span>.state = <span class=\"hljs-string\">'fulfilled'</span>\n<span class=\"lineNumber\">10</span>  <span class=\"hljs-built_in\">this</span>.value = value\n<span class=\"lineNumber\">11</span>}\n<span class=\"lineNumber\">12</span> \n<span class=\"lineNumber\">13</span>Yi.prototype.reject = <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">reason</span>) </span>{\n<span class=\"lineNumber\">14</span>  <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-built_in\">this</span>.state !== <span class=\"hljs-string\">'pending'</span>) <span class=\"hljs-keyword\">return</span>\n<span class=\"lineNumber\">15</span>  <span class=\"hljs-built_in\">this</span>.state = <span class=\"hljs-string\">'rejected'</span>\n<span class=\"lineNumber\">16</span>  <span class=\"hljs-built_in\">this</span>.value = reason\n<span class=\"lineNumber\">17</span>}</code></pre> \n\n<p>å¾ˆæ£’ï¼Œæ¥ç€è€ƒè™‘å…¶ä»–åŠŸèƒ½ï¼Œ<code>Yi</code>åº”è¯¥å®ç°<code>then</code>æ–¹æ³•ï¼</p>\n<blockquote>\n<p><code>then</code>æ–¹æ³•æ˜¯<code>Promise/A+</code>è§„èŒƒçš„æ ¸å¿ƒéƒ¨åˆ†ã€‚</p>\n</blockquote>\n<p>é‚£ä¹ˆï¼Œ<code>then</code>æ–¹æ³•å¿…é¡»æä¾›çš„åŠŸèƒ½åˆæœ‰å“ªäº›æ‰è¡Œå‘¢ï¼Ÿå‘ƒå‘ƒğŸ˜¯ï¼Œæƒ³æƒ³å¯èƒ½ä¼šæ˜¯ï¼š</p>\n<ul>\n<li><code>then</code>æ¥æ”¶ä¸¤ä¸ªæ–¹æ³•ï¼š<code>onFulfilled</code>å’Œ<code>onRejected</code></li>\n<li>è¿”å›ä¸€ä¸ªæ–°çš„<code>Yiï¼ˆPromiseï¼‰</code>å®ä¾‹ï¼Œè¿™æ ·å¯ä»¥è¿›è¡Œé“¾å¼è°ƒç”¨ã€‚</li>\n<li>åŒä¸€ä¸ª<code>Yi(Promise)</code>å®ä¾‹çš„<code>then</code>æ–¹æ³•å¯ä»¥æ‰§è¡Œå¾ˆå¤šæ¬¡ï¼Œæ¯æ¬¡éƒ½åº”è¯¥æŠŠæ–°çš„<code>Yiï¼ˆPromiseï¼‰</code>å®ä¾‹ä¿å­˜åˆ°ä¸€ä¸ªæ•°ç»„ä¸­ï¼Œä¸€ä¸ªå®ä¾‹å¯¹è±¡å¯èƒ½åœ¨å…¶ä¸åŒçŠ¶æ€ä¸‹æ³¨å†Œäº†è®¸å¤šçŠ¶æ€å˜æ›´åçš„å¼‚æ­¥ï¼Œæˆ‘ä»¬å°†ä¹‹äº¤ç»™<code>then</code>æˆ–è€…<code>catch</code>æ–¹æ³•æ–°ç”Ÿæˆçš„<code>Yi(Promise)</code>å®ä¾‹å»æ‰§è¡Œã€‚</li>\n<li><code>Yi</code>åº”è¯¥ç”¨ä¸€ä¸ªæ•°ç»„ä¿å­˜<code>then</code>æ³¨å†Œçš„çŠ¶æ€å˜æ›´å›è°ƒä»»åŠ¡ï¼Œåœ¨åˆé€‚çš„æ—¶å€™å°†å½“å‰<code>Yi(Promise)</code>å®ä¾‹çš„ä¸‹ä¸€ä¸ªçŠ¶æ€çš„å›è°ƒé€šè¿‡å¼‚æ­¥<code>Api</code>è°ƒç”¨ã€‚</li>\n</ul>\n<blockquote>\n<p>æ„é€ å™¨æ¥æ”¶çš„å‡½æ•°åº”è¯¥æ˜¯ä¸€ä¸ª<code>executor</code>å‡½æ•°å‚æ•°ï¼Œè¿™ä¸ªå‡½æ•°è¢«åŒæ­¥æ‰§è¡Œã€‚</p>\n</blockquote>\n<p>é‚£ä¹ˆï¼Œä¹‹å‰çš„ä»£ç åº”è¯¥æ”¹ä¸€æ”¹ï¼š</p>\n<pre><code class=\"hljs language-js\"><span class=\"lineNumber\">1</span><span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">Yi</span>(<span class=\"hljs-params\">executor</span>) </span>{\n<span class=\"lineNumber\">2</span>  <span class=\"hljs-built_in\">this</span>.state = <span class=\"hljs-string\">'pending'</span>\n<span class=\"lineNumber\">3</span>  <span class=\"hljs-built_in\">this</span>.value = <span class=\"hljs-literal\">undefined</span>\n<span class=\"lineNumber\">4</span>  <span class=\"hljs-built_in\">this</span>.consumers = []\n<span class=\"lineNumber\">5</span>  executor(<span class=\"hljs-built_in\">this</span>.resolve.bind(<span class=\"hljs-built_in\">this</span>), <span class=\"hljs-built_in\">this</span>.reject.bind(<span class=\"hljs-built_in\">this</span>))\n<span class=\"lineNumber\">6</span>}\n<span class=\"lineNumber\">7</span> \n<span class=\"lineNumber\">8</span>Yi.prototype.resolve = <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">value</span>) </span>{\n<span class=\"lineNumber\">9</span>  <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-built_in\">this</span>.state !== <span class=\"hljs-string\">'pending'</span>) <span class=\"hljs-keyword\">return</span>\n<span class=\"lineNumber\">10</span>  <span class=\"hljs-built_in\">this</span>.state = <span class=\"hljs-string\">'fulfilled'</span>\n<span class=\"lineNumber\">11</span>  <span class=\"hljs-built_in\">this</span>.value = value\n<span class=\"lineNumber\">12</span>  <span class=\"hljs-comment\">// çŠ¶æ€å˜æ›´åˆ™å¹¿æ’­ç»™è‡ªå·±çš„ consumers</span>\n<span class=\"lineNumber\">13</span>  <span class=\"hljs-built_in\">this</span>.broadcast()\n<span class=\"lineNumber\">14</span>}\n<span class=\"lineNumber\">15</span> \n<span class=\"lineNumber\">16</span>Yi.prototype.reject = <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">reason</span>) </span>{\n<span class=\"lineNumber\">17</span>  <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-built_in\">this</span>.state !== <span class=\"hljs-string\">'pending'</span>) <span class=\"hljs-keyword\">return</span>\n<span class=\"lineNumber\">18</span>  <span class=\"hljs-built_in\">this</span>.state = <span class=\"hljs-string\">'rejected'</span>\n<span class=\"lineNumber\">19</span>  <span class=\"hljs-built_in\">this</span>.value = reason\n<span class=\"lineNumber\">20</span>  <span class=\"hljs-comment\">// çŠ¶æ€å˜æ›´åˆ™å¹¿æ’­ç»™è‡ªå·±çš„ consumers</span>\n<span class=\"lineNumber\">21</span>  <span class=\"hljs-built_in\">this</span>.broadcast()\n<span class=\"lineNumber\">22</span>}</code></pre> \n\n<p><code>æ„é€ å™¨</code>å†…éƒ¨ç”¨ä¸€ä¸ª<code>consumers</code>æ•°ç»„ä¿å­˜<code>then</code>å’Œ<code>catch</code>å®ä¾‹æ–¹æ³•ä¸­å®ä¾‹åŒ–çš„<code>Yi(promise)</code>å¯¹è±¡ã€‚</p>\n<p>åœ¨<code>then</code>æ–¹æ³•ä¸­éœ€è¦å®ä¾‹åŒ–ä¸€ä¸ªæ–°çš„<code>Yi(Promise)</code>å¯¹è±¡ï¼Œå¹¶ä¸”ä¸ºä¹‹å®šä¹‰<code>settled</code>çŠ¶æ€åçš„å±æ€§<code>onFulfilled</code>å’Œ<code>onRejected</code>ï¼Œæ‰§è¡Œå¼‚æ­¥ä»»åŠ¡çš„é€»è¾‘ï¼Œç”¨ä¸€ä¸ª<code>broadcase</code>å‡½æ•°å°è£…èµ·æ¥ï¼š</p>\n<pre><code class=\"hljs language-js\"><span class=\"lineNumber\">1</span>Yi.prototype.then = <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">onFulfilled, onRejected</span>) </span>{\n<span class=\"lineNumber\">2</span>  <span class=\"hljs-keyword\">const</span> promise = <span class=\"hljs-keyword\">new</span> Yi(<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>) </span>{})\n<span class=\"lineNumber\">3</span>  <span class=\"hljs-comment\">// ç°åœ¨ï¼Œè¿™ä¸ªè¿”å›ä¸”è¢«ä¿å­˜åˆ°å½“å‰ Yi å®ä¾‹çš„ consumers æ•°ç»„ä¸­çš„æ–°å®ä¾‹å…·æœ‰äº†ä¸¤ä¸ªçŠ¶æ€ç¨³å®šåçš„å±æ€§</span>\n<span class=\"lineNumber\">4</span>  promise.onFulfilled = <span class=\"hljs-keyword\">typeof</span> onFulfilled === <span class=\"hljs-string\">'function'</span> ? onFulfilled : <span class=\"hljs-literal\">undefined</span>\n<span class=\"lineNumber\">5</span>  promise.onRejected = <span class=\"hljs-keyword\">typeof</span> onRejected === <span class=\"hljs-string\">'function'</span> ? onRejected : <span class=\"hljs-literal\">undefined</span>\n<span class=\"lineNumber\">6</span>  <span class=\"hljs-built_in\">this</span>.consumers.push(promise)\n<span class=\"lineNumber\">7</span>  <span class=\"hljs-comment\">// å‘å‡ºå¹¿æ’­ï¼Œå½“æ—§çš„ Yi å®ä¾‹ä¸º settled çŠ¶æ€ä¸‹çš„æ—¶å€™å¯ä»¥ç›´æ¥è°ƒç”¨ç›¸å…³å±æ€§ä»»åŠ¡</span>\n<span class=\"lineNumber\">8</span>  <span class=\"hljs-built_in\">this</span>.broadcast()\n<span class=\"lineNumber\">9</span>  <span class=\"hljs-keyword\">return</span> promise\n<span class=\"lineNumber\">10</span>}\n<span class=\"lineNumber\">11</span> \n<span class=\"lineNumber\">12</span>Yi.prototype.broadcast = <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>) </span>{\n<span class=\"lineNumber\">13</span>  <span class=\"hljs-keyword\">const</span> promise = <span class=\"hljs-built_in\">this</span>;\n<span class=\"lineNumber\">14</span>  <span class=\"hljs-comment\">// called after promise is resolved</span>\n<span class=\"lineNumber\">15</span>  <span class=\"hljs-keyword\">if</span>(<span class=\"hljs-built_in\">this</span>.state === <span class=\"hljs-string\">'pending'</span>) <span class=\"hljs-keyword\">return</span>\n<span class=\"lineNumber\">16</span> \n<span class=\"lineNumber\">17</span>  <span class=\"hljs-keyword\">const</span> callbackType = <span class=\"hljs-built_in\">this</span>.state === <span class=\"hljs-string\">'fulfilled'</span> ? <span class=\"hljs-string\">'onFulfilled'</span> : <span class=\"hljs-string\">'onRejected'</span>\n<span class=\"lineNumber\">18</span>  <span class=\"hljs-keyword\">const</span> toSettled = <span class=\"hljs-built_in\">this</span>.state === <span class=\"hljs-string\">'fulfilled'</span> ? <span class=\"hljs-string\">'resolve'</span> : <span class=\"hljs-string\">'reject'</span>\n<span class=\"lineNumber\">19</span> \n<span class=\"lineNumber\">20</span>  <span class=\"hljs-built_in\">setTimeout</span>(<span class=\"hljs-function\">() =></span> {\n<span class=\"lineNumber\">21</span>    <span class=\"hljs-comment\">// å½“çŠ¶æ€æ”¹å˜åå°†æ­¤å‰ then ä¿å­˜çš„ consumers å†…çš„ promise å…¨éƒ¨å¹¿æ’­ä¸€éçŠ¶æ€å˜æ›´çš„æ¶ˆæ¯ï¼Œå¹¶ä¸”æ¸…ç©ºæ­¤æ•°ç»„</span>\n<span class=\"lineNumber\">22</span>    promise.consumers.splice(<span class=\"hljs-number\">0</span>).forEach(<span class=\"hljs-function\"><span class=\"hljs-params\">consumer</span> =></span> {\n<span class=\"lineNumber\">23</span>      <span class=\"hljs-keyword\">try</span> {\n<span class=\"lineNumber\">24</span>        <span class=\"hljs-keyword\">const</span> callback = consumer[callbackType]\n<span class=\"lineNumber\">25</span>        <span class=\"hljs-comment\">// å¦‚æœ promise å…·æœ‰ onFulfilled æˆ–è€… onRejected æ–¹æ³•ï¼Œåœ¨ then æ–¹æ³•æ‰§è¡Œçš„æ—¶å€™æ·»åŠ çš„</span>\n<span class=\"lineNumber\">26</span>        <span class=\"hljs-comment\">// åœ¨ then çš„æ—¶å€™åˆ¤å®šæ˜¯å¦ä¸ºå‡½æ•°ï¼Œä¸æ˜¯å‡½æ•°åˆ™ callback ä¸º undefined</span>\n<span class=\"lineNumber\">27</span>        <span class=\"hljs-function\"><span class=\"hljs-title\">if</span>(<span class=\"hljs-params\">callback</span>)</span> {\n<span class=\"lineNumber\">28</span>          consumer.resolve(callback(promise.value))\n<span class=\"lineNumber\">29</span>        } <span class=\"hljs-keyword\">else</span> {\n<span class=\"lineNumber\">30</span>          <span class=\"hljs-comment\">// callback ä¸æ˜¯å‡½æ•°ï¼Œé‚£å°±é»˜è®¤æŒ‰çŠ¶æ€æ”¹å˜å€¼</span>\n<span class=\"lineNumber\">31</span>          <span class=\"hljs-comment\">// çŠ¶æ€è½¬ä¸º settled</span>\n<span class=\"lineNumber\">32</span>          consumer[toSettled](promise.value)\n<span class=\"lineNumber\">33</span>        }\n<span class=\"lineNumber\">34</span>      } <span class=\"hljs-keyword\">catch</span> (e) {\n<span class=\"lineNumber\">35</span>        <span class=\"hljs-comment\">// å¼‚å¸¸æ•è·ä¸º Rejected çŠ¶æ€ä¸‹çš„ reason</span>\n<span class=\"lineNumber\">36</span>        consumer.reject(e)\n<span class=\"lineNumber\">37</span>      }\n<span class=\"lineNumber\">38</span>    })\n<span class=\"lineNumber\">39</span>  }, <span class=\"hljs-number\">0</span>);\n<span class=\"lineNumber\">40</span>}</code></pre> \n\n<p>å¯¹äºç±»ä¼¼ç¬”è€…è¿™ç§åŠŸåŠ›ä¸è¶³çš„å¼€å‘è€…æ¥è¯´ï¼Œä¸ºäº†æ›´å¥½åœ°å®ç°<code>Yi</code>ï¼Œç†è§£<code>Promise</code>çš„åŸç†ï¼Œæˆ‘æƒ³å¯ä»¥é™ä½æ•´ä½“çš„å¤æ‚åº¦ï¼Œå…ˆç”¨<code>setTimeout</code>æ¨¡æ‹Ÿå¾®ä»»åŠ¡ï¼Œåç»­æœ€ç»ˆç‰ˆæœ¬ä¸€å®šä¼šæŒ‰å¹³å°é€šè¿‡<code>nextTick</code>æˆ–è€…<code>MutationObserver</code>æ¥æ›¿æ¢<code>setTimeout</code>ã€‚</p>\n<p>è¯è¯´å›æ¥ï¼Œ<code>then</code>æ–¹æ³•ä¸­æˆ‘ä»¬å®ä¾‹åŒ–ä¸€ä¸ªä¸ä¼šåœ¨<code>executor</code>ä¸­åŒæ­¥è®©è‡ªå·±è¿›å…¥<code>settled</code>çŠ¶æ€çš„<code>Yi(promise)</code>å®ä¾‹ï¼Œå¹¶ä¸”æ ¹æ®å½“å‰çš„å®ä¾‹çŠ¶æ€ä¸ºè¿™ä¸ªæ–°çš„å®ä¾‹æ·»åŠ äº†ä¸¤ä¸ªå±æ€§æ–¹æ³•<code>onFulfilled</code>å’Œ<code>onRejected</code>ï¼Œç„¶åå°†ä¹‹æ”¾å…¥å½“å‰å®ä¾‹çš„<code>consumers</code>æ•°ç»„ä¸­æš‚å­˜ã€‚</p>\n<p>æ¥ç€ï¼Œæˆ‘ä»¬è°ƒç”¨äº†ä¸€ä¸ªæ ¸å¿ƒå‡½æ•°ï¼š<code>broadcast</code>ã€‚</p>\n<p>ç§ç§å…¶å®ç°ï¼Œå¦‚è‹¥å½“å‰å®ä¾‹åœ¨<code>pending</code>çŠ¶æ€ä¸‹è°ƒç”¨æ­¤æ–¹æ³•ï¼Œæˆ‘ä»¬ç›´æ¥è¿”å›ã€‚</p>\n<p>åªæœ‰è¿›å…¥<code>settled</code>çŠ¶æ€ï¼Œæˆ‘ä»¬å†æ ¹æ®å…¶çŠ¶æ€<code>fulfilled</code>æˆ–è€…<code>rejected</code>æ¥è·å–æˆ‘ä»¬å°†è¦è°ƒç”¨çš„å¼‚æ­¥ä»»åŠ¡å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯åœ¨<code>then</code>æ–¹æ³•çš„<code>executor</code>å‡½æ•°ä¸­ä¸ºæ–°<code>Yi(Promise)</code>å®ä¾‹åˆ›å»ºçš„å±æ€§æ–¹æ³•ã€‚</p>\n<p>æˆ‘ä»¬ä¸ºåˆå§‹åŒ–çš„<code>Yi(Promise)</code>å®ä¾‹é€šè¿‡<code>then</code>ä¼ å…¥çš„çŠ¶æ€å˜æ›´å¤„ç†å‡½æ•°<code>onFulfilled</code>å’Œ<code>onRejected</code>èµ‹å€¼ç»™äº†å†…éƒ¨æ–°å®ä¾‹åŒ–ï¼Œä¸”åœ¨<code>then</code>ä¸­è¿”å›çš„<code>Yi(Promise)</code>å®ä¾‹ã€‚</p>\n<p>åœ¨<code>resolve</code>ã€<code>reject</code>è¿™ä¸¤ä¸ªå¯ä»¥å˜æ›´å®ä¾‹çŠ¶æ€çš„æ–¹æ³•ä¸­è°ƒç”¨äº†<code>broadcast</code>æ–¹æ³•ã€‚</p>\n<p>å› ä¸ºè€ŒçŠ¶æ€å˜æ›´ä¼šè®©æ‰€æœ‰çš„å…ƒç´ éƒ½æ‰§è¡Œ<code>then</code>ä¸­æ·»åŠ çš„å¼‚æ­¥ä»»åŠ¡ï¼Œå¹¶ä¸”æˆ‘ä»¬çš„å®ä¾‹å¯ä»¥åœ¨ä¸åŒæ—¶æœºå¤šæ¬¡è°ƒç”¨<code>then</code>æ–¹æ³•æ–°å¢<code>consumers</code>çš„å…ƒç´ ï¼Œå› æ­¤éœ€è¦åœ¨é€‚å½“çš„æ—¶æœºæ¸…ç©ºå½“å‰å®ä¾‹çš„<code>consumers</code>æ•°ç»„ã€‚</p>\n<p>å¯¹äºä¸€ä¸ª<code>Promise</code>çš„å®ç°æ¥è¯´ï¼Œæˆ‘ä»¬è¿˜éœ€è¦æ·»åŠ ä¸€ä¸ª<code>catch</code>æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•å¯ä»¥çœ‹æˆ<code>then</code>æ–¹æ³•çš„è¯­æ³•ç³–ã€‚</p>\n<pre><code class=\"hljs language-js\"><span class=\"lineNumber\">1</span>Yi.prototype.catch = <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">onRejected</span>) </span>{\n<span class=\"lineNumber\">2</span>  <span class=\"hljs-keyword\">return</span> <span class=\"hljs-built_in\">this</span>.then(<span class=\"hljs-literal\">undefined</span>, onRejected)\n<span class=\"lineNumber\">3</span>}</code></pre> \n\n","title":"å®ç°ä¸€ä¸ªPromise-A+è§„èŒƒçš„Promiseç±»","date":"2021/5/12","tags":["JavaScript"],"mainImg":"https://images.unsplash.com/photo-1616523197635-78aa12a1f36f?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=MnwxNjUyNjZ8MHwxfHJhbmRvbXx8fHx8fHx8fDE2MjA3NDk4ODc&ixlib=rb-1.2.1&q=80&w=1080","coverImg":"https://images.unsplash.com/photo-1616523197635-78aa12a1f36f?crop=entropy&cs=tinysrgb&fit=max&fm=jpg&ixid=MnwxNjUyNjZ8MHwxfHJhbmRvbXx8fHx8fHx8fDE2MjA3NDk4ODc&ixlib=rb-1.2.1&q=80&w=400","intro":"ä¸ºäº†å­¦ä¹  Promise çš„åŸç†ï¼ŒåŠ æ·±å¯¹å¼‚æ­¥ Promise çš„ç†è§£ï¼Œæˆ‘ä»¬å¾ˆæœ‰å¿…è¦å­¦ä¹ å¦‚ä½•å®ç°ä¸€ä¸ªç¬¦åˆ Promise/A+ è§„èŒƒçš„ Promise ç±»"}},"__N_SSG":true}